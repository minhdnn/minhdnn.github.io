import{r as i,_ as T,j as e,s as be,t as ge,m as v,g as K,b as ee,a as H,d as Y,e as fe,n as ye,u as we,K as je,f as ve}from"./app.js";import{S as Q}from"./chunk-Section.js";const o={lowercase:"abcdefghijklmnopqrstuvwxyz",uppercase:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",numbers:"0123456789",symbols:"!@#$%^&*()_+-=[]{}|;:'\",.<>/?~`"},C={lowercase:"text-green-400",uppercase:"text-yellow-400",numbers:"text-sky-400",symbols:"text-rose-400",default:"text-white"},ke=s=>o.lowercase.includes(s)?"lowercase":o.uppercase.includes(s)?"uppercase":o.numbers.includes(s)?"numbers":o.symbols.includes(s)?"symbols":"default",Ne=s=>s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Se=new RegExp(`[${Ne(o.symbols)}]`),Ce=new Set(["password","123456","12345678","qwerty","12345","123456789","111111","password123","admin","user","iloveyou"]),Z="abcdefghijklmnopqrstuvwxyz",J="0123456789",Pe=["qwertyuiop","asdfghjkl","zxcvbnm"],V=[{level:0,bits:25,name:"Very Weak",comment:"Way too weak. A password like this could be cracked in seconds. Avoid using it anywhere, even for temporary stuff.",color:"#ef4444"},{level:1,bits:40,name:"Weak",comment:"Still pretty weak. Maybe okay for throwaway accounts or temporary logins, but don't use this where it matters.",color:"#f97316"},{level:2,bits:60,name:"Fair",comment:"Not terrible, but not great either. Could work for low-risk accounts, but consider making it longer or adding more variety.",color:"#eab308"},{level:3,bits:80,name:"Moderate",comment:"Decent. Probably fine for casual sites or apps, but don't use it for banking, email, or anything sensitive.",color:"#a3e635"},{level:4,bits:100,name:"Strong",comment:"Nice! This would work well for most accounts. Still, using a password manager to create and store it is your best bet.",color:"#4ade80"},{level:5,bits:120,name:"Very Strong",comment:"Solid stuff. You can confidently use this for sensitive accounts like your email or cloud storage.",color:"#22c55e"},{level:6,bits:1/0,name:"Excellent",comment:"Top-tier. This one's ready for high-security needs like financial accounts, admin panels, or encrypted drives.",color:"#06b6d4"}],Te=[{level:0,name:"Very Weak",color:"#ef4444"},{level:1,name:"Weak",color:"#f97316"},{level:2,name:"Fair",color:"#eab308"},{level:3,name:"Moderate",color:"#a3e635"},{level:4,name:"Strong",color:"#4ade80"},{level:5,name:"Very Strong",color:"#22c55e"},{level:6,name:"Excellent",color:"#06b6d4"}],te=s=>{if(!s)return{finalEntropy:0,penaltyReasons:[],baseEntropy:0,penalties:0};const r=s.length;let a=0;if(/[a-z]/.test(s)&&(a+=26),/[A-Z]/.test(s)&&(a+=26),/[0-9]/.test(s)&&(a+=10),Se.test(s)&&(a+=o.symbols.length),a===0)return{finalEntropy:0,penaltyReasons:[],baseEntropy:0,penalties:0};const m=r*Math.log2(a);let u=0;const l=[],c=s.toLowerCase();for(const d of Ce)if(c.includes(d)){u+=20,l.includes("common")||l.push("common");break}const y={};for(const d of c)y[d]=(y[d]||0)+1;const b=Object.values(y).reduce((d,p)=>d+(p>1?(p-1)*3:0),0);b>r&&(u+=b,l.includes("repetition")||l.push("repetition"));let w=0;for(let d=0;d<c.length-2;d++){const p=c.substring(d,d+3);(Z.includes(p)||Z.split("").reverse().join("").includes(p)||J.includes(p)||J.split("").reverse().join("").includes(p))&&(w+=3)}w>0&&(u+=w,l.includes("sequence")||l.push("sequence"));let g=0;for(const d of Pe)for(let p=0;p<c.length-2;p++){const E=c.substring(p,p+3);(d.includes(E)||[...d].reverse().join("").includes(E))&&(g+=4)}return g>0&&(u+=g,l.includes("keyboard")||l.push("keyboard")),{finalEntropy:Math.max(0,m-u),penaltyReasons:l,baseEntropy:m,penalties:u}},X=s=>{if(!s)return null;const{finalEntropy:r}=te(s);let a;return r>=120?a=6:r>=100?a=5:r>=80?a=4:r>=60?a=3:r>=40?a=2:r>=25?a=1:a=0,Te[a]},G=s=>{if(s<1)return"< 1 second";if(s<60)return`${Math.round(s)} seconds`;if(s<3600)return`${Math.round(s/60)} minutes`;if(s<86400)return`${Math.round(s/3600)} hours`;if(s<31536e3)return`${Math.round(s/86400)} days`;const r=s/31536e3;return r<1e3?`${Math.round(r)} years`:r<1e6?`${(r/1e3).toFixed(1)}k years`:r<1e9?`${(r/1e6).toFixed(1)}m years`:r<1e12?`${(r/1e9).toFixed(1)}b years`:"Eternity"},Ee=s=>{if(!s)return null;const{finalEntropy:r,penaltyReasons:a,baseEntropy:m,penalties:u}=te(s),l=Math.pow(2,r),c={laptop:G(l/1e6),gpuCluster:G(l/1e9),supercomputer:G(l/1e12)},y=V.find(w=>r<w.bits)||V[V.length-1];let b=y.comment;return u>m*.4&&a.length>0&&(a.includes("common")?b="Uh-oh — this password contains something super common. Hackers try these first, so it's not safe for anything.":a.includes("repetition")?b="It looks long, but there's too much repetition. That makes it easier to crack than you'd think.":a.includes("sequence")?b="Avoid patterns like 'abc' or '123' — they're predictable and easy to brute-force.":a.includes("keyboard")&&(b="Patterns like 'qwerty' or 'asdf' are a hacker's favorite guess. Try mixing things up more.")),{...y,comment:b,length:s.length,entropy:Math.round(r),crackTimes:c}},N=s=>{const r=Math.floor(4294967295/s)*s;let a;do{const m=new Uint32Array(1);crypto.getRandomValues(m),a=m[0]}while(a>=r);return a%s},Re=s=>{const r=s.getHours().toString().padStart(2,"0"),a=s.getMinutes().toString().padStart(2,"0"),m=s.getSeconds().toString().padStart(2,"0"),u=s.getDate().toString().padStart(2,"0"),l=(s.getMonth()+1).toString().padStart(2,"0"),c=s.getFullYear();return`${r}:${a}:${m} - ${u}/${l}/${c}`},M=({id:s,label:r,checked:a,onChange:m,colorClass:u})=>e.jsxs("label",{htmlFor:s,className:"flex items-center gap-2 cursor-pointer select-none text-slate-300 hover:text-white transition-colors p-2 rounded-lg hover:bg-white/10",children:[e.jsx("input",{id:s,type:"checkbox",className:"sr-only",checked:a,onChange:m}),e.jsx("div",{className:`w-5 h-5 rounded border-2 ${a?"bg-sky-500 border-sky-400":"bg-transparent border-slate-500"} flex items-center justify-center transition-all`,children:a&&e.jsx(ee,{className:"w-3.5 h-3.5 text-white"})}),e.jsx("span",{className:`text-sm font-medium ${u}`,children:r})]}),$e=()=>{var _;const s=i.useRef(null),r=i.useRef(null),[a,m]=i.useState(""),[u,l]=i.useState(""),[c,y]=i.useState(16),[b,w]=i.useState("16"),[g,O]=i.useState({includeUppercase:!0,includeLowercase:!0,includeNumbers:!0,includeSymbols:!0}),[d,p]=i.useState(!0),[E,$]=i.useState(!1),[se,re]=i.useState(null),[A,ae]=i.useState(null),[L,ne]=i.useState(null),[oe,le]=i.useState(0),[F,ie]=i.useState([]),[U,ce]=i.useState(!1),R=t=>{const{id:n,checked:h}=t.target;O(f=>({...f,[n]:h}))},de=t=>{const n=t.target.value;/^\d*$/.test(n)&&n.length<4&&w(n)},ue=()=>{let t=parseInt(b,10);(isNaN(t)||b==="")&&(t=16),t<1&&(t=1),t>64&&(t=64),y(t),w(String(t))},me=t=>{const n=parseInt(t.target.value,10);y(n),w(String(n))},D=i.useCallback(()=>{const{includeLowercase:t,includeUppercase:n,includeNumbers:h,includeSymbols:f}=g;let x="";const j=[];if(t&&(x+=o.lowercase,j.push(o.lowercase[N(o.lowercase.length)])),n&&(x+=o.uppercase,j.push(o.uppercase[N(o.uppercase.length)])),h&&(x+=o.numbers,j.push(o.numbers[N(o.numbers.length)])),f&&(x+=o.symbols,j.push(o.symbols[N(o.symbols.length)])),x==="")return T.error("Please select at least one character type."),null;const P=c-j.length,W=[];if(P>0)for(let k=0;k<P;k++)W.push(x[N(x.length)]);const S=[...j,...W].slice(0,c);for(let k=S.length-1;k>0;k--){const B=N(k+1);[S[k],S[B]]=[S[B],S[k]]}return S.join("")},[g,c]),q=i.useCallback((t,n)=>{let h=0;const f=setInterval(()=>{let x="";const j=o.lowercase+o.uppercase+o.numbers+o.symbols;for(let P=0;P<t;P++)x+=j[N(j.length)];l(x),h>=10&&(clearInterval(f),l(n),m(n)),h++},20)},[]),I=i.useCallback(()=>{const t=D();if(t){if(r.current!==t){const n={password:t,timestamp:new Date};ie(h=>[n,...h.slice(0,9)])}r.current!==null&&t!==r.current&&le(n=>n+1),r.current=t,q(c,t)}else l(""),m(""),r.current="";setTimeout(()=>{ae(X(t||"")),$(!1)},220)},[D,c,q]),pe=()=>{var n;const t=((n=s.current)==null?void 0:n.value)||"";re(Ee(t)),ne(X(t))};i.useEffect(()=>{I()},[I]);const z=()=>{const t=a;t&&(navigator.clipboard.writeText(t),$(!0),T.success("Password copied to clipboard!"),setTimeout(()=>$(!1),2e3))},he=async()=>{try{const t=h=>Array.from(crypto.getRandomValues(new Uint8Array(h)),f=>"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"[f%62]).join(""),n=h=>new Promise(f=>setTimeout(f,h));await navigator.clipboard.writeText(t(32)),await n(50),await navigator.clipboard.writeText(t(32)),await n(50),await navigator.clipboard.writeText(""),T.success("Clipboard cleared for security.")}catch(t){T.error("Could not clear clipboard."),console.error("Failed to clear clipboard: ",t)}},xe=({report:t})=>{if(!t)return null;const n=({rating:h})=>e.jsx("div",{className:"flex justify-center items-center gap-0.5",children:[...Array(6)].map((f,x)=>e.jsx(ve,{className:`w-4 h-4 transition-colors ${x<h?"text-yellow-400":"text-slate-600"}`},x))});return e.jsxs("div",{className:"p-4 bg-slate-900/30 border border-slate-700/50 rounded-lg space-y-3",children:[e.jsx("p",{className:"text-center font-semibold text-lg sm:text-xl",style:{color:t.color},children:t.comment}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-x-4 gap-y-2 pt-3 border-t border-slate-700/50 text-sm text-slate-400 text-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-slate-500",children:"Rating"}),e.jsx(n,{rating:Math.min(t.level+1,6)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-slate-500",children:"Length"}),e.jsx("strong",{className:"text-slate-200 text-base",children:t.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-slate-500",children:"Entropy"}),e.jsxs("strong",{className:"text-slate-200 text-base",children:[t.entropy," bits"]})]})]}),e.jsxs("div",{className:"pt-3 border-t border-slate-700/50 mt-3",children:[e.jsx("h4",{className:"text-center font-medium text-slate-300 mb-2",children:"Estimated Time to Crack"}),e.jsxs("div",{className:"text-xs text-slate-400 grid grid-cols-1 sm:grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-bold block text-slate-200",children:t.crackTimes.laptop}),e.jsx("span",{className:"text-slate-500",children:"Laptop (~1M/s)"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold block text-slate-200",children:t.crackTimes.gpuCluster}),e.jsx("span",{className:"text-slate-500",children:"GPU Cluster (~1B/s)"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold block text-slate-200",children:t.crackTimes.supercomputer}),e.jsx("span",{className:"text-slate-500",children:"Supercomputer (~1T/s)"})]})]})]})]})};return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
                input[type=number]::-webkit-inner-spin-button, input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
                input[type=number] { -moz-appearance: textfield; }
                .range-thumb { -webkit-appearance: none; appearance: none; background: transparent; cursor: pointer; width: 100%; }
                .range-thumb:focus { outline: none; }
                .range-thumb::-webkit-slider-runnable-track { width: 100%; height: 4px; cursor: pointer; background: #475569; border-radius: 2px; }
                .range-thumb::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; height: 20px; width: 20px; background-color: #0ea5e9; border-radius: 50%; border: 2px solid white; margin-top: -8px; transition: transform 0.1s ease-in-out; }
                .range-thumb:hover::-webkit-slider-thumb { transform: scale(1.1); }
                .range-thumb::-moz-range-track { width: 100%; height: 4px; cursor: pointer; background: #475569; border-radius: 2px; }
                .range-thumb::-moz-range-thumb { height: 18px; width: 18px; background-color: #0ea5e9; border-radius: 50%; border: 2px solid white; transition: transform 0.1s ease-in-out; }
                .range-thumb:hover::-moz-range-thumb { transform: scale(1.1); }
            `}),e.jsx(Q,{title:"Password Generator",icon:e.jsx(je,{}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end items-baseline -mb-4",children:A&&e.jsx("span",{className:"font-bold text-lg",style:{color:A.color},children:A.name})}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("div",{className:"w-full p-4 pr-32 sm:pr-36 font-mono text-sm sm:text-lg tracking-tight sm:tracking-wider bg-slate-900/50 border border-slate-700 rounded-lg flex items-center h-[60px] overflow-hidden","aria-label":"Generated Password",children:e.jsx("div",{className:"flex whitespace-nowrap",children:d?Array.from(u).map((t,n)=>e.jsx("span",{className:C[ke(t)]||C.default,children:t},n)):e.jsx("span",{className:"text-slate-400",children:"•".repeat(u.length)})})}),e.jsxs("div",{className:"absolute right-1 sm:right-2 flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>p(t=>!t),className:"p-1.5 sm:p-2 text-slate-400 hover:text-white transition-colors rounded-lg","aria-label":"Toggle password visibility",children:d?e.jsx(be,{className:"w-5 h-5"}):e.jsx(ge,{className:"w-5 h-5"})}),e.jsx("button",{onClick:I,className:"p-1.5 sm:p-2 text-slate-400 hover:text-white transition-colors rounded-lg",title:"Regenerate password","aria-label":"Regenerate password",children:e.jsx(v.div,{animate:{rotate:[0,360]},transition:{duration:.4,ease:"easeInOut"},children:e.jsx(K,{className:"w-5 h-5"})},oe)}),e.jsx("button",{onClick:z,className:"p-1.5 sm:p-2 text-slate-400 hover:text-white transition-colors rounded-lg","aria-label":"Copy password",children:E?e.jsx(ee,{className:"w-5 h-5 text-green-400"}):e.jsx(H,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"space-y-6 pt-4 border-t border-slate-800",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{htmlFor:"length-text",className:"text-sm font-medium text-slate-300 whitespace-nowrap",children:"Password length"}),e.jsx("input",{id:"length-text",type:"text",inputMode:"numeric",min:"1",max:"64",value:b,onChange:de,onBlur:ue,className:"w-20 p-2 text-center bg-slate-700 border border-slate-600 rounded-md"}),e.jsx("input",{id:"length-slider",type:"range",min:"1",max:"64",value:c,onChange:me,className:"w-full range-thumb"})]}),e.jsx(Y,{children:c<12&&e.jsxs(v.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex items-center gap-2 text-xs text-amber-400 bg-amber-900/20 border-l-4 border-amber-500 px-3 py-1.5 rounded-r-lg",children:[e.jsx(fe,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:"Short passwords are easy prey. Make it 12+ characters to stay safe."})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-x-6 gap-y-3 items-center",children:[e.jsx(M,{id:"includeUppercase",label:"Uppercase",checked:g.includeUppercase,onChange:R,colorClass:C.uppercase}),e.jsx(M,{id:"includeLowercase",label:"Lowercase",checked:g.includeLowercase,onChange:R,colorClass:C.lowercase}),e.jsx(M,{id:"includeNumbers",label:"Numbers",checked:g.includeNumbers,onChange:R,colorClass:C.numbers}),e.jsx(M,{id:"includeSymbols",label:"Symbols",checked:g.includeSymbols,onChange:R,colorClass:C.symbols})]})]}),e.jsxs("div",{className:"space-y-4 pt-6 border-t border-slate-800",children:[e.jsxs(v.button,{onClick:I,whileHover:{scale:1.02,boxShadow:"0 0 15px rgba(56, 189, 248, 0.2)"},whileTap:{scale:.98},className:"w-full flex items-center justify-center bg-sky-500/20 hover:bg-sky-500/30 border border-sky-500/40 text-sky-200 font-semibold py-3 px-4 rounded-lg shadow-md",children:[e.jsx(K,{className:"w-5 h-5 mr-2"}),"Generate New Password"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs(v.button,{onClick:z,disabled:!a,whileHover:{scale:1.02,boxShadow:"0 0 15px rgba(99, 102, 241, 0.2)"},whileTap:{scale:.98},className:"w-full flex items-center justify-center bg-indigo-500/20 hover:bg-indigo-500/30 border border-indigo-500/40 text-indigo-200 font-semibold py-3 px-4 rounded-lg shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(H,{className:"w-5 h-5 mr-2"}),"Copy Generated Password"]}),e.jsxs(v.button,{onClick:he,whileHover:{scale:1.02,boxShadow:"0 0 15px rgba(244, 63, 94, 0.2)"},whileTap:{scale:.98},className:"w-full flex items-center justify-center bg-rose-500/20 hover:bg-rose-500/30 border border-rose-500/40 text-rose-300 font-semibold py-3 px-4 rounded-lg shadow-md",children:[e.jsx(ye,{className:"w-5 h-5 mr-2"}),"Clear Clipboard (Security)"]})]})]}),F.length>0&&e.jsxs("div",{className:"pt-6 border-t border-slate-800",children:[e.jsxs(v.button,{onClick:()=>ce(t=>!t),whileHover:{scale:1.01},whileTap:{scale:.99},className:"flex items-center justify-between w-full p-3 bg-slate-800/50 hover:bg-slate-700/50 rounded-lg text-base font-medium text-white transition-colors","aria-expanded":U,"aria-controls":"password-history-list",children:[e.jsx("span",{children:"Generation History"}),e.jsx(we,{className:`w-5 h-5 transition-transform duration-300 ${U?"rotate-180":""}`})]}),e.jsx(Y,{children:U&&e.jsx(v.div,{id:"password-history-list",initial:{height:0,opacity:0,marginTop:0},animate:{height:"auto",opacity:1,marginTop:"0.75rem"},exit:{height:0,opacity:0,marginTop:0},className:"overflow-hidden",children:e.jsx("ul",{className:"space-y-2",children:F.map((t,n)=>e.jsxs(v.li,{layout:!0,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,x:-20},transition:{duration:.2,type:"spring",stiffness:300,damping:30},className:"flex items-start justify-between p-3 bg-slate-800/50 border border-slate-700/60 rounded-lg",children:[e.jsxs("div",{className:"flex-grow pr-4",children:[e.jsx("span",{className:"font-mono text-sm text-slate-300 tracking-wider break-all",children:t.password}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:Re(t.timestamp)})]}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(t.password),T.success("Password copied from history")},className:"p-1.5 text-slate-400 hover:text-white transition-colors rounded-lg flex-shrink-0","aria-label":"Copy password from history",children:e.jsx(H,{className:"w-4 h-4"})})]},`${t.password}-${n}`))})})})]})]})}),e.jsx(Q,{title:"Password Strength Evaluator",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end items-baseline -mb-4",children:L&&e.jsx("span",{className:"font-bold text-lg",style:{color:L.color},children:L.name})}),e.jsx("input",{ref:s,type:"text",onChange:pe,placeholder:"Type or paste a password to check",className:"w-full p-4 font-mono bg-slate-800/60 border border-slate-600/80 rounded-lg text-white focus:ring-2 focus:ring-sky-400","aria-label":"Password to evaluate"}),((_=s.current)==null?void 0:_.value)&&e.jsx(v.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-4",children:e.jsx(xe,{report:se})})]})})]})};export{$e as default};
