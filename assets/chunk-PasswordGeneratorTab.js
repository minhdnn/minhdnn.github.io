import{r as d,_ as P,j as e,q as ce,s as de,Q as ue,b as Z,a as H,d as W,m as k,e as me,t as he,l as pe,K as be,f as xe}from"./app.js";import{S as B}from"./chunk-Section.js";const u={lowercase:"abcdefghijklmnopqrstuvwxyz",uppercase:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",numbers:"0123456789",symbols:"!@#$%^&*()_+-=[]{}|;:'\",.<>/?~`"},ge=s=>s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),fe=new RegExp(`[${ge(u.symbols)}]`),ye=new Set(["password","123456","12345678","qwerty","12345","123456789","111111","password123","admin","user","iloveyou"]),D="abcdefghijklmnopqrstuvwxyz",K="0123456789",we=["qwertyuiop","asdfghjkl","zxcvbnm"],I=[{level:0,bits:25,name:"Paper Lock",comment:"Password? More like a Post-it note!",color:"#ef4444"},{level:1,bits:40,name:"Weak Sauce",comment:"Could stop a curious toddler… maybe.",color:"#f97316"},{level:2,bits:60,name:"Plastic Lock",comment:"Might hold off a nosy cat.",color:"#eab308"},{level:3,bits:80,name:"Office Safe",comment:"A hacker might need to skip lunch for this one!",color:"#a3e635"},{level:4,bits:100,name:"Spy-Grade",comment:"Even the NSA might frown a bit.",color:"#4ade80"},{level:5,bits:120,name:"Fortress-Class",comment:"Even a quantum computer would sweat.",color:"#22c55e"},{level:6,bits:1/0,name:"God-Tier",comment:"The password just locked you back.",color:"#06b6d4"}],je=[{level:1,name:"Very Weak",color:"#ef4444"},{level:2,name:"Weak",color:"#f97316"},{level:3,name:"Medium",color:"#eab308"},{level:4,name:"Strong",color:"#a3e635"},{level:5,name:"Very Strong",color:"#4ade80"},{level:6,name:"Military Grade",color:"#06b6d4"}],J=s=>{if(!s)return{finalEntropy:0,penaltyReasons:[],baseEntropy:0,penalties:0};const r=s.length;let a=0;if(/[a-z]/.test(s)&&(a+=26),/[A-Z]/.test(s)&&(a+=26),/[0-9]/.test(s)&&(a+=10),fe.test(s)&&(a+=u.symbols.length),a===0)return{finalEntropy:0,penaltyReasons:[],baseEntropy:0,penalties:0};const m=r*Math.log2(a);let h=0;const l=[],c=s.toLowerCase();for(const o of ye)if(c.includes(o)){h+=20,l.includes("common")||l.push("common");break}const g={};for(const o of c)g[o]=(g[o]||0)+1;const p=Object.values(g).reduce((o,i)=>o+(i>1?(i-1)*3:0),0);p>r&&(h+=p,l.includes("repetition")||l.push("repetition"));let w=0;for(let o=0;o<c.length-2;o++){const i=c.substring(o,o+3);(D.includes(i)||D.split("").reverse().join("").includes(i)||K.includes(i)||K.split("").reverse().join("").includes(i))&&(w+=3)}w>0&&(h+=w,l.includes("sequence")||l.push("sequence"));let S=0;for(const o of we)for(let i=0;i<c.length-2;i++){const C=c.substring(i,i+3);(o.includes(C)||[...o].reverse().join("").includes(C))&&(S+=4)}return S>0&&(h+=S,l.includes("keyboard")||l.push("keyboard")),{finalEntropy:Math.max(0,m-h),penaltyReasons:l,baseEntropy:m,penalties:h}},Q=s=>{if(!s)return null;const{finalEntropy:r}=J(s);let a;return r>=110?a=5:r>=90?a=4:r>=70?a=3:r>=50?a=2:r>=30?a=1:a=0,je[a]},A=s=>{if(s<1)return"< 1 second";if(s<60)return`${Math.round(s)} seconds`;if(s<3600)return`${Math.round(s/60)} minutes`;if(s<86400)return`${Math.round(s/3600)} hours`;if(s<31536e3)return`${Math.round(s/86400)} days`;const r=s/31536e3;return r<1e3?`${Math.round(r)} years`:r<1e6?`${(r/1e3).toFixed(1)}k years`:r<1e9?`${(r/1e6).toFixed(1)}m years`:r<1e12?`${(r/1e9).toFixed(1)}b years`:"Eternity"},Y=s=>{if(!s)return null;const{finalEntropy:r,penaltyReasons:a,baseEntropy:m,penalties:h}=J(s),l=Math.pow(2,r),c={laptop:A(l/1e6),gpuCluster:A(l/1e9),supercomputer:A(l/1e12)},g=I.find(w=>r<w.bits)||I[I.length-1];let p=g.comment;return h>m*.4&&a.length>0&&(a.includes("repetition")?p="Looks long, but its high repetition makes it very predictable.":a.includes("sequence")?p="Using sequential letters or numbers (like 'abc' or '123') is a weak pattern.":a.includes("common")?p="This contains a common password, making it extremely easy to guess.":a.includes("keyboard")&&(p="Keyboard patterns like 'qwerty' are one of the first things hackers try.")),{...g,comment:p,length:s.length,entropy:Math.round(r),crackTimes:c}},N=s=>{const r=Math.floor(4294967295/s)*s;let a;do{const m=new Uint32Array(1);crypto.getRandomValues(m),a=m[0]}while(a>=r);return a%s},T=({id:s,label:r,checked:a,onChange:m})=>e.jsxs("label",{htmlFor:s,className:"flex items-center gap-2 cursor-pointer select-none text-slate-300 hover:text-white transition-colors p-2 rounded-lg hover:bg-white/10",children:[e.jsx("input",{id:s,type:"checkbox",className:"sr-only",checked:a,onChange:m}),e.jsx("div",{className:`w-5 h-5 rounded border-2 ${a?"bg-sky-500 border-sky-400":"bg-transparent border-slate-500"} flex items-center justify-center transition-all`,children:a&&e.jsx(Z,{className:"w-3.5 h-3.5 text-white"})}),e.jsx("span",{className:"text-sm",children:r})]}),Ne=()=>{var O,V;const s=d.useRef(null),r=d.useRef(null),[a,m]=d.useState(14),[h,l]=d.useState("14"),[c,g]=d.useState({includeUppercase:!0,includeLowercase:!0,includeNumbers:!0,includeSymbols:!0}),[p,w]=d.useState(!0),[S,U]=d.useState(!1),[o,i]=d.useState(!1),[C,X]=d.useState(null),[ee,te]=d.useState(null),[R,se]=d.useState(null),[M,ae]=d.useState(null),E=t=>{const{id:n,checked:x}=t.target;g(f=>({...f,[n]:x}))},re=t=>{const n=t.target.value;/^\d*$/.test(n)&&n.length<4&&l(n)},ne=()=>{let t=parseInt(h,10);(isNaN(t)||h==="")&&(t=14),t<1&&(t=1),t>64&&(t=64),m(t),l(String(t))},le=t=>{const n=parseInt(t.target.value,10);m(n),l(String(n))},$=d.useCallback(()=>{const{includeLowercase:t,includeUppercase:n,includeNumbers:x,includeSymbols:f}=c;let b="";const j=[];if(t&&(b+=u.lowercase,j.push(u.lowercase[N(u.lowercase.length)])),n&&(b+=u.uppercase,j.push(u.uppercase[N(u.uppercase.length)])),x&&(b+=u.numbers,j.push(u.numbers[N(u.numbers.length)])),f&&(b+=u.symbols,j.push(u.symbols[N(u.symbols.length)])),b==="")return P.error("Please select at least one character type."),null;const z=a-j.length,F=[];if(z>0)for(let y=0;y<z;y++)F.push(b[N(b.length)]);const v=[...j,...F].slice(0,a);for(let y=v.length-1;y>0;y--){const _=N(y+1);[v[y],v[_]]=[v[_],v[y]]}return v.join("")},[c,a]),L=d.useCallback(()=>{const t=$();s.current&&(s.current.value=t||""),X(Y(t||"")),se(Q(t||"")),i(!1)},[$]),oe=()=>{var n;const t=((n=r.current)==null?void 0:n.value)||"";te(Y(t)),ae(Q(t))};d.useEffect(()=>{L()},[L]);const G=()=>{var n;const t=(n=s.current)==null?void 0:n.value;t&&(navigator.clipboard.writeText(t),i(!0),P.success("Password copied to clipboard!"),setTimeout(()=>i(!1),2e3))},ie=async()=>{try{const t=x=>Array.from(crypto.getRandomValues(new Uint8Array(x)),f=>"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"[f%62]).join(""),n=x=>new Promise(f=>setTimeout(f,x));await navigator.clipboard.writeText(t(32)),await n(50),await navigator.clipboard.writeText(t(32)),await n(50),await navigator.clipboard.writeText(""),P.success("Clipboard cleared for security.")}catch(t){P.error("Could not clear clipboard."),console.error("Failed to clear clipboard: ",t)}},q=({report:t})=>{if(!t)return null;const n=({rating:x})=>e.jsx("div",{className:"flex justify-center items-center gap-0.5",children:[...Array(6)].map((f,b)=>e.jsx(xe,{className:`w-4 h-4 transition-colors ${b<x?"text-yellow-400":"text-slate-600"}`},b))});return e.jsxs("div",{className:"p-4 bg-slate-900/30 border border-slate-700/50 rounded-lg space-y-3",children:[e.jsxs("p",{className:"text-center font-semibold text-lg sm:text-xl",style:{color:t.color},children:[t.name," – ",e.jsxs("span",{className:"italic",children:["“",t.comment,"”"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-x-4 gap-y-2 pt-3 border-t border-slate-700/50 text-sm text-slate-400 text-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-slate-500",children:"Rating"}),e.jsx(n,{rating:Math.min(t.level+1,6)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-slate-500",children:"Length"}),e.jsx("strong",{className:"text-slate-200 text-base",children:t.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-slate-500",children:"Entropy"}),e.jsxs("strong",{className:"text-slate-200 text-base",children:[t.entropy," bits"]})]})]}),e.jsxs("div",{className:"pt-3 border-t border-slate-700/50 mt-3",children:[e.jsx("h4",{className:"text-center font-medium text-slate-300 mb-2",children:"Estimated Time to Crack"}),e.jsxs("div",{className:"text-xs text-slate-400 grid grid-cols-1 sm:grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-bold block text-slate-200",children:t.crackTimes.laptop}),e.jsx("span",{className:"text-slate-500",children:"Laptop (~1M/s)"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold block text-slate-200",children:t.crackTimes.gpuCluster}),e.jsx("span",{className:"text-slate-500",children:"GPU Cluster (~1B/s)"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold block text-slate-200",children:t.crackTimes.supercomputer}),e.jsx("span",{className:"text-slate-500",children:"Supercomputer (~1T/s)"})]})]})]})]})};return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
                input[type=number]::-webkit-inner-spin-button, input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
                input[type=number] { -moz-appearance: textfield; }
                .range-thumb { -webkit-appearance: none; appearance: none; background: transparent; cursor: pointer; width: 100%; }
                .range-thumb:focus { outline: none; }
                .range-thumb::-webkit-slider-runnable-track { width: 100%; height: 4px; cursor: pointer; background: #475569; border-radius: 2px; }
                .range-thumb::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; height: 20px; width: 20px; background-color: #0ea5e9; border-radius: 50%; border: 2px solid white; margin-top: -8px; transition: transform 0.1s ease-in-out; }
                .range-thumb:hover::-webkit-slider-thumb { transform: scale(1.1); }
                .range-thumb::-moz-range-track { width: 100%; height: 4px; cursor: pointer; background: #475569; border-radius: 2px; }
                .range-thumb::-moz-range-thumb { height: 18px; width: 18px; background-color: #0ea5e9; border-radius: 50%; border: 2px solid white; transition: transform 0.1s ease-in-out; }
                .range-thumb:hover::-moz-range-thumb { transform: scale(1.1); }
            `}),e.jsx(B,{title:"Password Generator",icon:e.jsx(be,{}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end items-baseline -mb-4",children:R&&e.jsx("span",{className:"font-bold text-lg",style:{color:R.color},children:R.name})}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("input",{ref:s,type:p?"text":"password",readOnly:!0,className:"w-full p-4 pr-36 font-mono text-lg tracking-wider bg-slate-900/50 border border-slate-700 rounded-lg text-white focus:outline-none","aria-label":"Generated Password"}),e.jsxs("div",{className:"absolute right-2 flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>w(t=>!t),className:"p-2 text-slate-400 hover:text-white transition-colors","aria-label":"Toggle password visibility",children:p?e.jsx(ce,{className:"w-5 h-5"}):e.jsx(de,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>U(t=>!t),className:"p-2 text-slate-400 hover:text-white transition-colors","aria-label":"Toggle password evaluation details",children:e.jsx(ue,{className:"w-5 h-5"})}),e.jsx("button",{onClick:G,className:"p-2 text-slate-400 hover:text-white transition-colors","aria-label":"Copy password",children:o?e.jsx(Z,{className:"w-5 h-5 text-green-400"}):e.jsx(H,{className:"w-5 h-5"})})]})]}),e.jsx(W,{children:S&&e.jsx(k.div,{initial:{opacity:0,height:0,marginTop:0},animate:{opacity:1,height:"auto",marginTop:"1rem"},exit:{opacity:0,height:0,marginTop:0},transition:{duration:.3},className:"overflow-hidden",children:e.jsx(q,{report:C})})}),e.jsxs("div",{className:"space-y-6 pt-4 border-t border-slate-800",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{htmlFor:"length-text",className:"text-sm font-medium text-slate-300 whitespace-nowrap",children:"Password length"}),e.jsx("input",{id:"length-text",type:"text",inputMode:"numeric",min:"1",max:"64",value:h,onChange:re,onBlur:ne,className:"w-20 p-2 text-center bg-slate-700 border border-slate-600 rounded-md"}),e.jsx("input",{id:"length-slider",type:"range",min:"1",max:"64",value:a,onChange:le,className:"w-full range-thumb"})]}),e.jsx(W,{children:a<12&&e.jsxs(k.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex items-center gap-2 text-xs text-amber-400 bg-amber-900/20 border-l-4 border-amber-500 px-3 py-1.5 rounded-r-lg",children:[e.jsx(me,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:"Short passwords are easy prey. Make it 12+ characters to stay safe."})]})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-6 gap-y-3",children:[e.jsx(T,{id:"includeUppercase",label:"Uppercase",checked:c.includeUppercase,onChange:E}),e.jsx(T,{id:"includeLowercase",label:"Lowercase",checked:c.includeLowercase,onChange:E}),e.jsx(T,{id:"includeNumbers",label:"Numbers",checked:c.includeNumbers,onChange:E}),e.jsx(T,{id:"includeSymbols",label:"Symbols",checked:c.includeSymbols,onChange:E})]})]}),e.jsxs("div",{className:"space-y-4 pt-6 border-t border-slate-800",children:[e.jsxs(k.button,{onClick:L,whileHover:{scale:1.02,boxShadow:"0 0 15px rgba(56, 189, 248, 0.2)"},whileTap:{scale:.98},className:"w-full flex items-center justify-center bg-sky-500/20 hover:bg-sky-500/30 border border-sky-500/40 text-sky-200 font-semibold py-3 px-4 rounded-lg shadow-md",children:[e.jsx(he,{className:"w-5 h-5 mr-2"}),"Generate New Password"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs(k.button,{onClick:G,disabled:!((O=s.current)!=null&&O.value),whileHover:{scale:1.02,boxShadow:"0 0 15px rgba(99, 102, 241, 0.2)"},whileTap:{scale:.98},className:"w-full flex items-center justify-center bg-indigo-500/20 hover:bg-indigo-500/30 border border-indigo-500/40 text-indigo-200 font-semibold py-3 px-4 rounded-lg shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(H,{className:"w-5 h-5 mr-2"}),"Copy Generated Password"]}),e.jsxs(k.button,{onClick:ie,whileHover:{scale:1.02,boxShadow:"0 0 15px rgba(244, 63, 94, 0.2)"},whileTap:{scale:.98},className:"w-full flex items-center justify-center bg-rose-500/20 hover:bg-rose-500/30 border border-rose-500/40 text-rose-300 font-semibold py-3 px-4 rounded-lg shadow-md",children:[e.jsx(pe,{className:"w-5 h-5 mr-2"}),"Clear Clipboard (Security)"]})]})]})]})}),e.jsx(B,{title:"Password Strength Evaluator",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end items-baseline -mb-4",children:M&&e.jsx("span",{className:"font-bold text-lg",style:{color:M.color},children:M.name})}),e.jsx("input",{ref:r,type:"text",onChange:oe,placeholder:"Type or paste a password to check",className:"w-full p-4 font-mono bg-slate-800/60 border border-slate-600/80 rounded-lg text-white focus:ring-2 focus:ring-sky-400","aria-label":"Password to evaluate"}),((V=r.current)==null?void 0:V.value)&&e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-4",children:e.jsx(q,{report:ee})})]})})]})};export{Ne as default};
