import{r as i,_ as I,j as e,q as pe,s as he,Q as be,b as X,a as H,d as B,m as k,e as xe,t as ge,l as fe,K as ye,f as we}from"./app.js";import{S as K}from"./chunk-Section.js";const l={lowercase:"abcdefghijklmnopqrstuvwxyz",uppercase:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",numbers:"0123456789",symbols:"!@#$%^&*()_+-=[]{}|;:'\",.<>/?~`"},S={lowercase:"text-green-400",uppercase:"text-yellow-400",numbers:"text-sky-400",symbols:"text-rose-400",default:"text-white"},je=t=>l.lowercase.includes(t)?"lowercase":l.uppercase.includes(t)?"uppercase":l.numbers.includes(t)?"numbers":l.symbols.includes(t)?"symbols":"default",ve=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Ne=new RegExp(`[${ve(l.symbols)}]`),ke=new Set(["password","123456","12345678","qwerty","12345","123456789","111111","password123","admin","user","iloveyou"]),Q="abcdefghijklmnopqrstuvwxyz",Y="0123456789",Se=["qwertyuiop","asdfghjkl","zxcvbnm"],G=[{level:0,bits:25,name:"Very Weak",comment:"This password is too weak. It won’t protect much.",color:"#ef4444"},{level:1,bits:40,name:"Weak",comment:"Still easy to guess. Try adding more characters or variety.",color:"#f97316"},{level:2,bits:60,name:"Fair",comment:"A little better, but it can be improved.",color:"#eab308"},{level:3,bits:80,name:"Moderate",comment:"Not bad. It offers basic protection, but could be stronger.",color:"#a3e635"},{level:4,bits:100,name:"Strong",comment:"Nice! This password is quite strong.",color:"#4ade80"},{level:5,bits:120,name:"Very Strong",comment:"Great job. This one is strong enough for serious protection.",color:"#22c55e"},{level:6,bits:1/0,name:"Excellent",comment:"Excellent. This is one of the strongest passwords possible.",color:"#06b6d4"}],Ce=[{level:0,name:"Very Weak",color:"#ef4444"},{level:1,name:"Weak",color:"#f97316"},{level:2,name:"Fair",color:"#eab308"},{level:3,name:"Moderate",color:"#a3e635"},{level:4,name:"Strong",color:"#4ade80"},{level:5,name:"Very Strong",color:"#22c55e"},{level:6,name:"Excellent",color:"#06b6d4"}],ee=t=>{if(!t)return{finalEntropy:0,penaltyReasons:[],baseEntropy:0,penalties:0};const r=t.length;let a=0;if(/[a-z]/.test(t)&&(a+=26),/[A-Z]/.test(t)&&(a+=26),/[0-9]/.test(t)&&(a+=10),Ne.test(t)&&(a+=l.symbols.length),a===0)return{finalEntropy:0,penaltyReasons:[],baseEntropy:0,penalties:0};const p=r*Math.log2(a);let d=0;const o=[],g=t.toLowerCase();for(const c of ke)if(g.includes(c)){d+=20,o.includes("common")||o.push("common");break}const f={};for(const c of g)f[c]=(f[c]||0)+1;const h=Object.values(f).reduce((c,u)=>c+(u>1?(u-1)*3:0),0);h>r&&(d+=h,o.includes("repetition")||o.push("repetition"));let b=0;for(let c=0;c<g.length-2;c++){const u=g.substring(c,c+3);(Q.includes(u)||Q.split("").reverse().join("").includes(u)||Y.includes(u)||Y.split("").reverse().join("").includes(u))&&(b+=3)}b>0&&(d+=b,o.includes("sequence")||o.push("sequence"));let C=0;for(const c of Se)for(let u=0;u<g.length-2;u++){const T=g.substring(u,u+3);(c.includes(T)||[...c].reverse().join("").includes(T))&&(C+=4)}return C>0&&(d+=C,o.includes("keyboard")||o.push("keyboard")),{finalEntropy:Math.max(0,p-d),penaltyReasons:o,baseEntropy:p,penalties:d}},Z=t=>{if(!t)return null;const{finalEntropy:r}=ee(t);let a;return r>=120?a=6:r>=100?a=5:r>=80?a=4:r>=60?a=3:r>=40?a=2:r>=25?a=1:a=0,Ce[a]},V=t=>{if(t<1)return"< 1 second";if(t<60)return`${Math.round(t)} seconds`;if(t<3600)return`${Math.round(t/60)} minutes`;if(t<86400)return`${Math.round(t/3600)} hours`;if(t<31536e3)return`${Math.round(t/86400)} days`;const r=t/31536e3;return r<1e3?`${Math.round(r)} years`:r<1e6?`${(r/1e3).toFixed(1)}k years`:r<1e9?`${(r/1e6).toFixed(1)}m years`:r<1e12?`${(r/1e9).toFixed(1)}b years`:"Eternity"},J=t=>{if(!t)return null;const{finalEntropy:r,penaltyReasons:a,baseEntropy:p,penalties:d}=ee(t),o=Math.pow(2,r),g={laptop:V(o/1e6),gpuCluster:V(o/1e9),supercomputer:V(o/1e12)},f=G.find(b=>r<b.bits)||G[G.length-1];let h=f.comment;return d>p*.4&&a.length>0&&(a.includes("repetition")?h="Looks long, but its high repetition makes it very predictable.":a.includes("sequence")?h="Using sequential letters or numbers (like 'abc' or '123') is a weak pattern.":a.includes("common")?h="This contains a common password, making it extremely easy to guess.":a.includes("keyboard")&&(h="Keyboard patterns like 'qwerty' are one of the first things hackers try.")),{...f,comment:h,length:t.length,entropy:Math.round(r),crackTimes:g}},v=t=>{const r=Math.floor(4294967295/t)*t;let a;do{const p=new Uint32Array(1);crypto.getRandomValues(p),a=p[0]}while(a>=r);return a%t},R=({id:t,label:r,checked:a,onChange:p,colorClass:d})=>e.jsxs("label",{htmlFor:t,className:"flex items-center gap-2 cursor-pointer select-none text-slate-300 hover:text-white transition-colors p-2 rounded-lg hover:bg-white/10",children:[e.jsx("input",{id:t,type:"checkbox",className:"sr-only",checked:a,onChange:p}),e.jsx("div",{className:`w-5 h-5 rounded border-2 ${a?"bg-sky-500 border-sky-400":"bg-transparent border-slate-500"} flex items-center justify-center transition-all`,children:a&&e.jsx(X,{className:"w-3.5 h-3.5 text-white"})}),e.jsx("span",{className:`text-sm font-medium ${d}`,children:r})]}),Pe=()=>{var _;const t=i.useRef(null),[r,a]=i.useState(""),[p,d]=i.useState(""),[o,g]=i.useState(16),[f,h]=i.useState("16"),[b,C]=i.useState({includeUppercase:!0,includeLowercase:!0,includeNumbers:!0,includeSymbols:!0}),[M,c]=i.useState(!0),[u,T]=i.useState(!1),[se,L]=i.useState(!1),[te,ae]=i.useState(null),[re,ne]=i.useState(null),[A,le]=i.useState(null),[U,oe]=i.useState(null),P=s=>{const{id:n,checked:x}=s.target;C(y=>({...y,[n]:x}))},ie=s=>{const n=s.target.value;/^\d*$/.test(n)&&n.length<4&&h(n)},ce=()=>{let s=parseInt(f,10);(isNaN(s)||f==="")&&(s=16),s<1&&(s=1),s>64&&(s=64),g(s),h(String(s))},de=s=>{const n=parseInt(s.target.value,10);g(n),h(String(n))},q=i.useCallback(()=>{const{includeLowercase:s,includeUppercase:n,includeNumbers:x,includeSymbols:y}=b;let m="";const w=[];if(s&&(m+=l.lowercase,w.push(l.lowercase[v(l.lowercase.length)])),n&&(m+=l.uppercase,w.push(l.uppercase[v(l.uppercase.length)])),x&&(m+=l.numbers,w.push(l.numbers[v(l.numbers.length)])),y&&(m+=l.symbols,w.push(l.symbols[v(l.symbols.length)])),m==="")return I.error("Please select at least one character type."),null;const E=o-w.length,W=[];if(E>0)for(let j=0;j<E;j++)W.push(m[v(m.length)]);const N=[...w,...W].slice(0,o);for(let j=N.length-1;j>0;j--){const D=v(j+1);[N[j],N[D]]=[N[D],N[j]]}return N.join("")},[b,o]),O=i.useCallback((s,n)=>{let x=0;const y=setInterval(()=>{let m="";const w=l.lowercase+l.uppercase+l.numbers+l.symbols;for(let E=0;E<s;E++)m+=w[v(w.length)];d(m),x>=10&&(clearInterval(y),d(n),a(n)),x++},20)},[]),$=i.useCallback(()=>{T(!1);const s=q();s?O(o,s):(d(""),a("")),setTimeout(()=>{ae(J(s||"")),le(Z(s||"")),L(!1)},220)},[q,o,O]),ue=()=>{var n;const s=((n=t.current)==null?void 0:n.value)||"";ne(J(s)),oe(Z(s))};i.useEffect(()=>{$()},[$]);const F=()=>{const s=r;s&&(navigator.clipboard.writeText(s),L(!0),I.success("Password copied to clipboard!"),setTimeout(()=>L(!1),2e3))},me=async()=>{try{const s=x=>Array.from(crypto.getRandomValues(new Uint8Array(x)),y=>"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"[y%62]).join(""),n=x=>new Promise(y=>setTimeout(y,x));await navigator.clipboard.writeText(s(32)),await n(50),await navigator.clipboard.writeText(s(32)),await n(50),await navigator.clipboard.writeText(""),I.success("Clipboard cleared for security.")}catch(s){I.error("Could not clear clipboard."),console.error("Failed to clear clipboard: ",s)}},z=({report:s})=>{if(!s)return null;const n=({rating:x})=>e.jsx("div",{className:"flex justify-center items-center gap-0.5",children:[...Array(6)].map((y,m)=>e.jsx(we,{className:`w-4 h-4 transition-colors ${m<x?"text-yellow-400":"text-slate-600"}`},m))});return e.jsxs("div",{className:"p-4 bg-slate-900/30 border border-slate-700/50 rounded-lg space-y-3",children:[e.jsxs("p",{className:"text-center font-semibold text-lg sm:text-xl",style:{color:s.color},children:[s.name," – ",e.jsxs("span",{className:"italic",children:["“",s.comment,"”"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-x-4 gap-y-2 pt-3 border-t border-slate-700/50 text-sm text-slate-400 text-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-slate-500",children:"Rating"}),e.jsx(n,{rating:Math.min(s.level+1,6)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-slate-500",children:"Length"}),e.jsx("strong",{className:"text-slate-200 text-base",children:s.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-slate-500",children:"Entropy"}),e.jsxs("strong",{className:"text-slate-200 text-base",children:[s.entropy," bits"]})]})]}),e.jsxs("div",{className:"pt-3 border-t border-slate-700/50 mt-3",children:[e.jsx("h4",{className:"text-center font-medium text-slate-300 mb-2",children:"Estimated Time to Crack"}),e.jsxs("div",{className:"text-xs text-slate-400 grid grid-cols-1 sm:grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-bold block text-slate-200",children:s.crackTimes.laptop}),e.jsx("span",{className:"text-slate-500",children:"Laptop (~1M/s)"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold block text-slate-200",children:s.crackTimes.gpuCluster}),e.jsx("span",{className:"text-slate-500",children:"GPU Cluster (~1B/s)"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold block text-slate-200",children:s.crackTimes.supercomputer}),e.jsx("span",{className:"text-slate-500",children:"Supercomputer (~1T/s)"})]})]})]})]})};return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
                input[type=number]::-webkit-inner-spin-button, input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
                input[type=number] { -moz-appearance: textfield; }
                .range-thumb { -webkit-appearance: none; appearance: none; background: transparent; cursor: pointer; width: 100%; }
                .range-thumb:focus { outline: none; }
                .range-thumb::-webkit-slider-runnable-track { width: 100%; height: 4px; cursor: pointer; background: #475569; border-radius: 2px; }
                .range-thumb::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; height: 20px; width: 20px; background-color: #0ea5e9; border-radius: 50%; border: 2px solid white; margin-top: -8px; transition: transform 0.1s ease-in-out; }
                .range-thumb:hover::-webkit-slider-thumb { transform: scale(1.1); }
                .range-thumb::-moz-range-track { width: 100%; height: 4px; cursor: pointer; background: #475569; border-radius: 2px; }
                .range-thumb::-moz-range-thumb { height: 18px; width: 18px; background-color: #0ea5e9; border-radius: 50%; border: 2px solid white; transition: transform 0.1s ease-in-out; }
                .range-thumb:hover::-moz-range-thumb { transform: scale(1.1); }
            `}),e.jsx(K,{title:"Password Generator",icon:e.jsx(ye,{}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end items-baseline -mb-4",children:A&&e.jsx("span",{className:"font-bold text-lg",style:{color:A.color},children:A.name})}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("div",{className:"w-full p-4 pr-28 sm:pr-36 font-mono text-sm sm:text-lg tracking-tight sm:tracking-wider bg-slate-900/50 border border-slate-700 rounded-lg flex items-center h-[60px] overflow-hidden","aria-label":"Generated Password",children:e.jsx("div",{className:"flex whitespace-nowrap",children:M?Array.from(p).map((s,n)=>e.jsx("span",{className:S[je(s)]||S.default,children:s},n)):e.jsx("span",{className:"text-slate-400",children:"•".repeat(p.length)})})}),e.jsxs("div",{className:"absolute right-1 sm:right-2 flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>c(s=>!s),className:"p-1.5 sm:p-2 text-slate-400 hover:text-white transition-colors","aria-label":"Toggle password visibility",children:M?e.jsx(pe,{className:"w-5 h-5"}):e.jsx(he,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>T(s=>!s),className:"p-1.5 sm:p-2 text-slate-400 hover:text-white transition-colors","aria-label":"Toggle password evaluation details",children:e.jsx(be,{className:"w-5 h-5"})}),e.jsx("button",{onClick:F,className:"p-1.5 sm:p-2 text-slate-400 hover:text-white transition-colors","aria-label":"Copy password",children:se?e.jsx(X,{className:"w-5 h-5 text-green-400"}):e.jsx(H,{className:"w-5 h-5"})})]})]}),e.jsx(B,{children:u&&e.jsx(k.div,{initial:{opacity:0,height:0,marginTop:0},animate:{opacity:1,height:"auto",marginTop:"1rem"},exit:{opacity:0,height:0,marginTop:0},transition:{duration:.3},className:"overflow-hidden",children:e.jsx(z,{report:te})})}),e.jsxs("div",{className:"space-y-6 pt-4 border-t border-slate-800",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{htmlFor:"length-text",className:"text-sm font-medium text-slate-300 whitespace-nowrap",children:"Password length"}),e.jsx("input",{id:"length-text",type:"text",inputMode:"numeric",min:"1",max:"64",value:f,onChange:ie,onBlur:ce,className:"w-20 p-2 text-center bg-slate-700 border border-slate-600 rounded-md"}),e.jsx("input",{id:"length-slider",type:"range",min:"1",max:"64",value:o,onChange:de,className:"w-full range-thumb"})]}),e.jsx(B,{children:o<12&&e.jsxs(k.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"flex items-center gap-2 text-xs text-amber-400 bg-amber-900/20 border-l-4 border-amber-500 px-3 py-1.5 rounded-r-lg",children:[e.jsx(xe,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:"Short passwords are easy prey. Make it 12+ characters to stay safe."})]})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-6 gap-y-3",children:[e.jsx(R,{id:"includeUppercase",label:"Uppercase",checked:b.includeUppercase,onChange:P,colorClass:S.uppercase}),e.jsx(R,{id:"includeLowercase",label:"Lowercase",checked:b.includeLowercase,onChange:P,colorClass:S.lowercase}),e.jsx(R,{id:"includeNumbers",label:"Numbers",checked:b.includeNumbers,onChange:P,colorClass:S.numbers}),e.jsx(R,{id:"includeSymbols",label:"Symbols",checked:b.includeSymbols,onChange:P,colorClass:S.symbols})]})]}),e.jsxs("div",{className:"space-y-4 pt-6 border-t border-slate-800",children:[e.jsxs(k.button,{onClick:$,whileHover:{scale:1.02,boxShadow:"0 0 15px rgba(56, 189, 248, 0.2)"},whileTap:{scale:.98},className:"w-full flex items-center justify-center bg-sky-500/20 hover:bg-sky-500/30 border border-sky-500/40 text-sky-200 font-semibold py-3 px-4 rounded-lg shadow-md",children:[e.jsx(ge,{className:"w-5 h-5 mr-2"}),"Generate New Password"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs(k.button,{onClick:F,disabled:!r,whileHover:{scale:1.02,boxShadow:"0 0 15px rgba(99, 102, 241, 0.2)"},whileTap:{scale:.98},className:"w-full flex items-center justify-center bg-indigo-500/20 hover:bg-indigo-500/30 border border-indigo-500/40 text-indigo-200 font-semibold py-3 px-4 rounded-lg shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(H,{className:"w-5 h-5 mr-2"}),"Copy Generated Password"]}),e.jsxs(k.button,{onClick:me,whileHover:{scale:1.02,boxShadow:"0 0 15px rgba(244, 63, 94, 0.2)"},whileTap:{scale:.98},className:"w-full flex items-center justify-center bg-rose-500/20 hover:bg-rose-500/30 border border-rose-500/40 text-rose-300 font-semibold py-3 px-4 rounded-lg shadow-md",children:[e.jsx(fe,{className:"w-5 h-5 mr-2"}),"Clear Clipboard (Security)"]})]})]})]})}),e.jsx(K,{title:"Password Strength Evaluator",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end items-baseline -mb-4",children:U&&e.jsx("span",{className:"font-bold text-lg",style:{color:U.color},children:U.name})}),e.jsx("input",{ref:t,type:"text",onChange:ue,placeholder:"Type or paste a password to check",className:"w-full p-4 font-mono bg-slate-800/60 border border-slate-600/80 rounded-lg text-white focus:ring-2 focus:ring-sky-400","aria-label":"Password to evaluate"}),((_=t.current)==null?void 0:_.value)&&e.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-4",children:e.jsx(z,{report:re})})]})})]})};export{Pe as default};
