import{r as N,j as t,m as g,k as J,Q as W,_ as D}from"./app.js";import{S as F}from"./chunk-Section.js";const k=({label:u,value:f,isPrimary:o=!1,className:M=""})=>t.jsxs("div",{className:`flex justify-between items-center py-2 ${o?"text-lg":"text-sm"} ${M}`,children:[t.jsx("span",{className:`${o?"font-semibold text-white":"text-slate-400"}`,children:u}),t.jsx("strong",{className:`${o?"text-white font-bold":"text-slate-200 font-medium"}`,children:f})]}),R=({title:u,enExplanation:f,viExplanation:o})=>t.jsxs("div",{className:"py-3 border-b border-slate-700/80 last:border-b-0",children:[t.jsx("h4",{className:"text-md font-semibold text-white mb-1.5",children:u}),t.jsxs("div",{className:"pl-1 space-y-1.5",children:[t.jsxs("p",{className:"text-sm text-slate-300",children:[t.jsx("strong",{className:"text-slate-100",children:"EN:"})," ",f]}),t.jsxs("p",{className:"text-sm text-slate-300",children:[t.jsx("strong",{className:"text-slate-100",children:"VI:"})," ",o]})]})]}),tt=()=>{const[u,f]=N.useState("1.000.000.000"),[o,M]=N.useState("8"),[j,z]=N.useState("200"),[p,C]=N.useState("equalPayments"),[x,V]=N.useState(null),[T,B]=N.useState(!1),b=(e,n="VND")=>isNaN(e)?`0 ${n}`:e.toLocaleString("vi-VN",{style:"currency",currency:n,minimumFractionDigits:0,maximumFractionDigits:0}),L=e=>{const n=parseFloat(String(e).replace(",","."));return isNaN(n)?0:n},S=e=>{const n=Number(String(e).replace(/\./g,""));return isNaN(n)?0:n},$=e=>{const n=e.target.value.replace(/[^0-9]/g,"");if(n==="")f("");else try{const l=BigInt(n),A=new Intl.NumberFormat("vi-VN").format(l);f(A)}catch{f(n)}},q=e=>{let n=e.target.value.replace(/[^0-9.,]/g,"");const l=n.split(/[.,]/);l.length>2&&(n=l[0]+"."+l.slice(1).join("")),M(n)},O=e=>{z(e.target.value.replace(/[^0-9]/g,""))},H=()=>{B(e=>!e)},E=()=>{const e=S(u),n=L(o),l=parseInt(j,10);return e<=0?"Loan amount must be greater than 0.":isNaN(n)||n<0?"Annual interest rate must be a non-negative number.":n>1e3?"Annual interest rate seems too high (max 1000%).":isNaN(l)||l<=0||!Number.isInteger(l)?"Loan term must be a positive integer (months).":l>600?"Loan term is too long (max 50 years / 600 months).":null},Y=()=>{const e=E();if(e){D.error(e);return}const n=new Promise((l,A)=>{setTimeout(()=>{try{const i=S(u),_=L(o)/100,G=parseInt(j,10),v=_/12,r=G,P=[];let a=i,w=0,I=0;if(p==="equalPayments"){let s;v===0?s=i/r:s=i*(v*Math.pow(1+v,r))/(Math.pow(1+v,r)-1),s=Math.round(s),I=s;for(let m=1;m<=r;m++){const c=Math.round(a*v);let d=s-c;m===r&&(d=a,s=d+c),a-=d,a<.01&&a>-.01&&(a=0),P.push({month:m,payment:s,principalPaid:d,interestPaid:c,remainingBalance:a}),w+=c}}else if(p==="fixedPrincipal"){const s=Math.round(i/r);let m=0;for(let c=1;c<=r;c++){const d=Math.round(a*v);let h=s;c===r&&(h=i-m);const y=h+d;c===1&&(I=y),a-=h,m+=h,a<.01&&a>-.01&&(a=0),P.push({month:c,payment:y,principalPaid:h,interestPaid:d,remainingBalance:a}),w+=d}}else{const s=Math.round(i*v),m=Math.round(i/r);I=m+s;let d=0;for(let h=1;h<=r;h++){let y=m;h===r&&(y=i-d);const U=y+s;a-=y,d+=y,a<.01&&a>-.01&&(a=0),P.push({month:h,payment:U,principalPaid:y,interestPaid:s,remainingBalance:a}),w+=s}}const K=i+w;l({displayMonthlyPayment:I,totalPrincipal:i,totalInterest:w,totalCost:K,amortizationSchedule:P,calculationMethod:p})}catch(i){A(i)}},500)});D.promise(n,{loading:"Calculating loan...",success:l=>(V(l),"Loan calculation complete!"),error:"An error occurred during calculation."})},Q=()=>u!==""&&S(u)>0&&o!==""&&L(o)>=0&&j!==""&&parseInt(j,10)>0;return t.jsxs(t.Fragment,{children:[t.jsx(F,{title:"Loan Calculator",icon:t.jsx(J,{}),children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsx("label",{className:"block text-sm font-semibold text-slate-300 mb-2",children:"Calculation Method"}),t.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 bg-slate-800/40 p-1.5 rounded-full",children:[t.jsxs(g.button,{onClick:()=>C("equalPayments"),className:`relative w-full sm:w-1/3 py-2 text-sm font-semibold rounded-full focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-400 ${p==="equalPayments"?"text-white":"text-slate-300 hover:bg-slate-700/50"}`,children:[p==="equalPayments"&&t.jsx(g.div,{layoutId:"loan-bubble",className:"absolute inset-0 bg-slate-700 rounded-full",transition:{type:"spring",stiffness:300,damping:25}}),t.jsx("span",{className:"relative z-10",children:"Equal Payments"})]}),t.jsxs(g.button,{onClick:()=>C("fixedPrincipal"),className:`relative w-full sm:w-1/3 py-2 text-sm font-semibold rounded-full focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-400 ${p==="fixedPrincipal"?"text-white":"text-slate-300 hover:bg-slate-700/50"}`,children:[p==="fixedPrincipal"&&t.jsx(g.div,{layoutId:"loan-bubble",className:"absolute inset-0 bg-slate-700 rounded-full",transition:{type:"spring",stiffness:300,damping:25}}),t.jsx("span",{className:"relative z-10",children:"Fixed Principal"})]}),t.jsxs(g.button,{onClick:()=>C("flatInterest"),className:`relative w-full sm:w-1/3 py-2 text-sm font-semibold rounded-full focus:outline-none focus-visible:ring-2 focus-visible:ring-sky-400 ${p==="flatInterest"?"text-white":"text-slate-300 hover:bg-slate-700/50"}`,children:[p==="flatInterest"&&t.jsx(g.div,{layoutId:"loan-bubble",className:"absolute inset-0 bg-slate-700 rounded-full",transition:{type:"spring",stiffness:300,damping:25}}),t.jsx("span",{className:"relative z-10",children:"Flat Interest"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"loanAmount",className:"block text-sm font-semibold text-slate-300 mb-2",children:"Loan Amount (VND)"}),t.jsx("input",{type:"text",id:"loanAmount",value:u,onChange:$,placeholder:"e.g., 1.000.000.000",className:"w-full p-3 rounded-lg bg-slate-800/60 border border-slate-600/80 focus:ring-2 focus:ring-sky-400 focus:border-sky-400 text-slate-100",inputMode:"text","aria-label":"Loan amount in VND"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"interestRate",className:"block text-sm font-semibold text-slate-300 mb-2",children:"Annual Interest Rate (%)"}),t.jsx("input",{type:"text",id:"interestRate",value:o,onChange:q,placeholder:"e.g., 8",className:"w-full p-3 rounded-lg bg-slate-800/60 border border-slate-600/80 focus:ring-2 focus:ring-sky-400 focus:border-sky-400 text-slate-100",inputMode:"decimal","aria-label":"Annual interest rate as a percentage"})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{htmlFor:"loanTerm",className:"block text-sm font-semibold text-slate-300 mb-2",children:"Loan Term (Months)"}),t.jsx("input",{type:"text",id:"loanTerm",value:j,onChange:O,placeholder:"e.g., 240",className:"w-full p-3 rounded-lg bg-slate-800/60 border border-slate-600/80 focus:ring-2 focus:ring-sky-400 focus:border-sky-400 text-slate-100",inputMode:"numeric","aria-label":"Loan term in months"})]})]}),t.jsx("div",{children:t.jsx(g.button,{onClick:Y,disabled:!Q(),whileHover:{scale:1.02,boxShadow:"0 0 15px rgba(56, 189, 248, 0.2)",borderColor:"rgba(56, 189, 248, 0.4)"},whileTap:{scale:.98},className:"w-full bg-sky-500/20 hover:bg-sky-500/30 border border-sky-500/40 backdrop-blur-sm text-sky-200 font-semibold py-3 px-4 rounded-lg shadow-md transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none text-base","aria-live":"polite",children:"Calculate Loan"})})]})}),x&&!E()&&t.jsxs(F,{title:"Results & Amortization Schedule",children:[t.jsxs("div",{className:"space-y-2 bg-slate-800/60 p-6 rounded-lg border border-slate-700 shadow-lg mb-8",children:[t.jsx(k,{label:x.calculationMethod==="fixedPrincipal"?"First Month's Payment:":"Monthly Payment:",value:b(x.displayMonthlyPayment),isPrimary:!0}),x.calculationMethod==="fixedPrincipal"&&t.jsx("p",{className:"text-xs text-slate-500 pl-1 -mt-1 mb-1",children:" (Payments decrease over time)"}),t.jsx(k,{label:"Total Principal Paid:",value:b(x.totalPrincipal)}),t.jsx(k,{label:"Total Interest Paid:",value:b(x.totalInterest)}),t.jsx(k,{label:"Total Loan Cost:",value:b(x.totalCost),className:"pt-2 border-t border-slate-700/50 mt-2"})]}),x.amortizationSchedule.length>0&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Detailed Amortization Schedule"}),t.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-700 shadow-md max-h-[500px]",children:t.jsxs("table",{className:"min-w-full divide-y divide-slate-700",children:[t.jsx("caption",{className:"sr-only",children:"Detailed monthly amortization schedule."}),t.jsx("thead",{className:"bg-slate-800 sticky top-0 z-10",children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",className:"px-3 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Month"}),t.jsx("th",{scope:"col",className:"px-3 py-3 text-right text-xs font-medium text-white uppercase tracking-wider",children:"Payment"}),t.jsx("th",{scope:"col",className:"px-3 py-3 text-right text-xs font-medium text-white uppercase tracking-wider",children:"Principal Paid"}),t.jsx("th",{scope:"col",className:"px-3 py-3 text-right text-xs font-medium text-white uppercase tracking-wider",children:"Interest Paid"}),t.jsx("th",{scope:"col",className:"px-3 py-3 text-right text-xs font-medium text-white uppercase tracking-wider",children:"Remaining Balance"})]})}),t.jsx("tbody",{className:"bg-slate-800/70 divide-y divide-slate-700",children:x.amortizationSchedule.map(e=>t.jsxs("tr",{className:"hover:bg-slate-700/50 transition-colors",children:[t.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm font-medium text-slate-200",children:e.month}),t.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-slate-300 text-right",children:b(e.payment)}),t.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-slate-300 text-right",children:b(e.principalPaid)}),t.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm text-slate-300 text-right",children:b(e.interestPaid)}),t.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-sm font-semibold text-white text-right",children:b(e.remainingBalance)})]},e.month))})]})})]})]}),t.jsxs(F,{title:"Understanding the Calculation Methods",icon:t.jsx(W,{}),children:[t.jsx(g.button,{whileHover:{scale:1.03,boxShadow:"0 0 15px rgba(56, 189, 248, 0.2)",borderColor:"rgba(56, 189, 248, 0.4)"},whileTap:{scale:.97},onClick:H,"aria-expanded":T,"aria-controls":"loan-instructions-content",className:"w-full sm:w-auto mb-4 bg-sky-500/20 hover:bg-sky-500/30 border border-sky-500/40 backdrop-blur-sm text-white font-semibold py-2 px-4 rounded-lg shadow-md transition-all duration-300 text-sm",children:T?"Hide Instructions":"Show Instructions"}),T&&t.jsxs(g.div,{id:"loan-instructions-content",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-1 overflow-hidden bg-slate-800/60 p-4 rounded-lg border border-slate-700 shadow-inner",children:[t.jsx(R,{title:"Equal Monthly Payments (Annuity) / Trả góp đều (Dư nợ giảm dần)",enExplanation:"You pay the same amount every month. In the beginning, a larger portion of your payment goes towards interest. Over time, more of your payment goes towards paying down the principal loan amount. This is the most common method for bank loans (e.g., mortgages, car loans).",viExplanation:"Bạn trả một số tiền không đổi mỗi tháng. Ban đầu, phần lớn số tiền trả sẽ dùng để trả lãi. Dần dần, phần lớn hơn trong khoản thanh toán sẽ dùng để trả nợ gốc. Đây là phương pháp phổ biến nhất cho các khoản vay ngân hàng (ví dụ: vay mua nhà, mua xe)."}),t.jsx(R,{title:"Fixed Principal, Declining Interest / Gốc cố định (Lãi giảm dần)",enExplanation:"You pay a fixed amount of the principal loan amount each month, plus interest on the remaining balance. Because the loan balance decreases every month, the interest portion also decreases, making your total monthly payment smaller over time.",viExplanation:"Bạn trả một khoản nợ gốc cố định mỗi tháng, cộng với tiền lãi trên số dư nợ còn lại. Vì số dư nợ giảm dần mỗi tháng, phần lãi cũng giảm theo, làm cho tổng số tiền thanh toán hàng tháng của bạn giảm dần theo thời gian."}),t.jsx(R,{title:"Flat Interest / Lãi suất phẳng",enExplanation:"Interest is calculated once on the initial loan amount and remains constant for the entire loan term. Your monthly payment is the sum of a fixed principal portion and this fixed interest portion. This method is simpler but often results in a higher total interest paid compared to declining balance methods.",viExplanation:"Lãi được tính một lần trên số tiền vay ban đầu và không đổi trong suốt thời hạn vay. Khoản thanh toán hàng tháng của bạn là tổng của một phần gốc cố định và phần lãi cố định này. Phương pháp này đơn giản hơn nhưng thường dẫn đến tổng số lãi phải trả cao hơn so với các phương pháp tính trên dư nợ giảm dần."})]})]})]})};export{tt as default};
