import{j as e,r as g,e as le,l as He,n as Ge,T as _e,o as We,f as je,m as S,M as Xe,i as we,p as Ke,Q as Qe,_ as X}from"./app.js";import{S as ie}from"./chunk-Section.js";import{R as Ue,L as Je,C as Ze,X as et,Y as tt,T as at,a as nt,b as st}from"./chunk-LineChart.js";const lt=({active:A,payload:v,label:y})=>{if(A&&v&&v.length){const j=r=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0}).format(r);return e.jsxs("div",{className:"p-4 bg-slate-800/80 backdrop-blur-sm rounded-lg shadow-xl border border-slate-600",children:[e.jsx("p",{className:"label font-bold text-slate-200",children:`Year ${y}`}),v.map((r,o)=>e.jsx("p",{style:{color:r.color},className:"text-sm",children:`${r.name}: ${j(r.value)}`},`item-${o}`))]})}return null},it=({data:A,scenarios:v})=>{const y="#94a3b8",j="#334155",r=o=>Math.abs(o)>=1e9?`${(o/1e9).toFixed(1)}B`:Math.abs(o)>=1e6?`${(o/1e6).toFixed(0)}M`:Math.abs(o)>=1e3?`${(o/1e3).toFixed(0)}K`:o.toString();return e.jsxs("div",{className:"mt-8 p-4 bg-black/10 backdrop-blur-sm rounded-lg border border-white/10",children:[e.jsx("h3",{className:"text-xl font-semibold text-white tracking-tight mb-6 text-center",children:"Net Equity Growth Over Time"}),e.jsx(Ue,{width:"100%",height:400,children:e.jsxs(Je,{data:A,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(Ze,{strokeDasharray:"3 3",stroke:j}),e.jsx(et,{dataKey:"year",stroke:y,tick:{fontSize:12}}),e.jsx(tt,{stroke:y,tick:{fontSize:12},tickFormatter:r}),e.jsx(at,{content:e.jsx(lt,{})}),e.jsx(nt,{wrapperStyle:{fontSize:"12px",color:"#cbd5e1"}}),v.filter(o=>o.enabled).map(o=>e.jsx(st,{type:"monotone",dataKey:o.name,name:o.name,stroke:o.color,strokeWidth:2,dot:!1,activeDot:{r:6}},o.id))]})})]})},rt=[{id:"bankDeposit",name:"Bank Deposit",color:"#38bdf8",enabled:!0,expectedReturn:"6",useLeverage:!1,loanInterestRate:"9",reinvest:!0,annualCosts:"0",loanType:"annuity"},{id:"realEstate",name:"Real Estate",color:"#f97316",enabled:!0,expectedReturn:"8",useLeverage:!1,loanInterestRate:"9",reinvest:!0,annualCosts:"1",loanType:"annuity"},{id:"gold",name:"Gold",color:"#fbbf24",enabled:!0,expectedReturn:"5",useLeverage:!1,loanInterestRate:"9",reinvest:!0,annualCosts:"0.5",loanType:"annuity"},{id:"stocks",name:"Stocks/Funds",color:"#4ade80",enabled:!0,expectedReturn:"12",useLeverage:!1,loanInterestRate:"9",reinvest:!0,annualCosts:"0.2",loanType:"annuity"}],ot=({content:A,onClose:v})=>{const{scenarioName:y,data:j}=A,r=i=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0}).format(i),o=j.some(i=>i.loanInterest!==void 0),D=j.some(i=>i.dcaAdded>0),H=j.some(i=>i.profitWithdrawn>0),G=["Year","Start Val",...D?["DCA"]:[],"Return","Costs",...H?["Pft W/D"]:[],"End Val",...o?["Loan Int.","Loan Prin.","End Loan"]:[],"Net Equity","Cash Flow"];return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:v,children:e.jsxs(S.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-slate-800 border border-slate-700 rounded-xl w-full max-w-6xl max-h-[90vh] flex flex-col",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-slate-600 flex justify-between items-center flex-shrink-0",children:[e.jsxs("h2",{className:"text-xl font-bold text-white",children:[y," - Yearly Cash Flow"]}),e.jsx("button",{onClick:v,className:"p-2 rounded-full text-slate-400 hover:bg-slate-700 leading-none text-2xl",children:"×"})]}),e.jsx("div",{className:"overflow-auto p-4",children:e.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-700 shadow-md",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-700 text-sm",children:[e.jsx("caption",{className:"sr-only",children:`Detailed yearly breakdown for ${y}.`}),e.jsx("thead",{className:"bg-slate-900 sticky top-0 z-10",children:e.jsx("tr",{children:G.map(i=>e.jsx("th",{scope:"col",className:"px-2 py-2 text-xs font-medium text-white uppercase tracking-wider text-right first:text-left",children:i},i))})}),e.jsx("tbody",{className:"bg-slate-800/70 divide-y divide-slate-700",children:j.map(i=>e.jsxs("tr",{className:"hover:bg-slate-700/50",children:[e.jsx("td",{className:"px-2 py-2 whitespace-nowrap font-medium text-slate-200 text-left",children:i.year}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-right text-slate-300",children:r(i.startingAssetValue)}),D&&e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-right text-green-400",children:r(i.dcaAdded)}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-right text-slate-300",children:r(i.appreciation)}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-right text-red-400",children:r(i.annualCosts)}),H&&e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-right text-amber-400",children:r(i.profitWithdrawn)}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-right text-slate-300",children:r(i.endingAssetValue)}),o&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-right text-red-400",children:r(i.loanInterest??0)}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-right text-slate-300",children:r(i.loanPrincipalPaid??0)}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-right text-slate-300",children:r(i.endingLoanBalance??0)})]}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-right font-semibold text-white",children:r(i.netEquity)}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-right font-medium",style:{color:i.cashFlow<0?"#f87171":"#4ade80"},children:r(i.cashFlow)})]},i.year))})]})})})]})})},ht=()=>{const[A,v]=g.useState("500.000.000"),[y,j]=g.useState("500.000.000"),[r,o]=g.useState("10"),[D,H]=g.useState("0"),[G,i]=g.useState("0"),[re,Ne]=g.useState(!1),[$,M]=g.useState(rt),[oe,Ce]=g.useState(0),[ce,ke]=g.useState(null),[O,Ae]=g.useState(null),[de,Ie]=g.useState([]),[ue,he]=g.useState(null),[K,Te]=g.useState(!1),V=t=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0}).format(t),Q=t=>Number(String(t).replace(/\./g,"")),U=t=>n=>{const a=n.target.value.replace(/[^0-9]/g,"");t(a===""?"":new Intl.NumberFormat("vi-VN").format(BigInt(a)))},xe=t=>n=>{let a=n.target.value.replace(/[^0-9.,-]/g,"");const l=a.split(/[.,]/);l.length>2&&(a=l[0]+"."+l.slice(1).join("")),t(a)},I=(t,n,a)=>{M(l=>l.map(c=>c.id===t?{...c,[n]:a}:c))},me=(t,n,a,l)=>{M(c=>c.map(h=>{if(h.id===t&&h.allocations){const b=[...h.allocations],C={...b[n]};return a==="scenarioId"?C.scenarioId=l:a==="percentage"&&(C.percentage=l.replace(/[^0-9.]/g,"")),b[n]=C,{...h,allocations:b}}return h}))},Re=t=>{M(n=>n.map(a=>{if(a.id===t&&a.allocations){const l={scenarioId:"stocks",percentage:"0"},c=[...a.allocations,l];return{...a,allocations:c}}return a}))},Ee=(t,n)=>{M(a=>a.map(l=>{if(l.id===t&&l.allocations){const c=l.allocations.filter((h,b)=>b!==n);return{...l,allocations:c}}return l}))},Le=()=>{const n={id:`mixed-${oe}`,name:`Mixed Portfolio ${oe+1}`,color:`#${(Math.random().toString(16)+"000000").substring(2,8)}`,enabled:!0,isMixed:!0,allocations:[{scenarioId:"stocks",percentage:"100"}],expectedReturn:"",annualCosts:"",useLeverage:!1,loanInterestRate:"9",reinvest:!0,loanType:"annuity"};M(a=>[...a,n]),Ce(a=>a+1)},Me=t=>{M(n=>n.filter(a=>a.id!==t))},Fe=t=>{if(!t.enabled||!t.useLeverage)return!1;const n=(parseFloat(t.expectedReturn)||0)-(parseFloat(t.annualCosts)||0),a=parseFloat(t.loanInterestRate)||0;return n<a},Pe=(t,n=.1)=>{let c=n;for(let h=0;h<50;h++){const b=t.reduce((x,k,m)=>x+k/Math.pow(1+c,m),0),C=t.reduce((x,k,m)=>m===0?x:x-m*k/Math.pow(1+c,m+1),0);if(Math.abs(C)<1e-10)return null;const s=c-b/C;if(Math.abs(s-c)<=1e-7)return s;c=s}return null},Se=()=>{const t=Q(A),n=Q(y),a=parseInt(r,10),l=Q(D),c=(parseFloat(G)||0)/100;if(t<=0||a<=0){X.error("Initial Capital and Investment Horizon must be positive numbers.");return}const h=$.filter(s=>s.enabled);if(h.length===0){X.error("Please enable at least one investment scenario to compare.");return}for(const s of h)if(s.isMixed&&s.allocations){const x=s.allocations.reduce((k,m)=>k+(parseFloat(m.percentage)||0),0);if(Math.abs(x-100)>.01){X.error(`Allocations for "${s.name}" must sum to 100%. Currently: ${x}%.`);return}}let b=[];const C=[];for(const s of h){let x,k;if(s.isMixed&&s.allocations){let d=0,f=0;const w=$.filter(R=>!R.isMixed);for(const R of s.allocations){const P=w.find(E=>E.id===R.scenarioId);if(P){const E=(parseFloat(R.percentage)||0)/100;d+=parseFloat(P.expectedReturn)/100*E,f+=parseFloat(P.annualCosts)/100*E}}x=d,k=f}else x=(parseFloat(s.expectedReturn)||0)/100,k=(parseFloat(s.annualCosts)||0)/100;const m=t,q=s.useLeverage?n:0,Ve=m+q,J=(parseFloat(s.loanInterestRate)||0)/100;let Z=0;if(s.useLeverage&&q>0&&a>0&&s.loanType==="annuity")if(J>0){const d=J,f=a;Z=q*(d*Math.pow(1+d,f))/(Math.pow(1+d,f)-1)}else Z=q/a;let p=Ve,u=q,pe=0,z=m,ee=0,te=[],ge=[],ae=[-m];const qe=p-u;te.push({year:0,netEquity:qe});for(let d=1;d<=a;d++){const f=p,w=l;p+=w,z+=w;const R=p*x,P=p+R,E=P*k,Ye=R-E;let W=0,se;s.reinvest?se=P-E:(se=f+w,W=Ye,ee+=W),p=se;let L=0,N=0;if(s.useLeverage&&u>0){switch(L=u*J,s.loanType){case"annuity":{N=Z-L,(d===a||N>u)&&(N=u);const Y=N+L;p-=Y,u-=N;break}case"interestOnly":{d===a&&(N=u);const Y=L+N;p-=Y,u-=N;break}case"balloon":{if(N=0,d===a){const Y=u+L;p-=Y,u=0}else u+=L;break}}pe+=L}u<1&&(u=0);const ve=p-u+ee,ye=-w+W;ae.push(ye),ge.push({year:d,startingAssetValue:f+w-l,dcaAdded:w,appreciation:R,profitWithdrawn:W,annualCosts:E,endingAssetValue:p,loanInterest:s.useLeverage?L:void 0,loanPrincipalPaid:s.useLeverage?N:void 0,endingLoanBalance:s.useLeverage?u:void 0,netEquity:ve,cashFlow:ye}),te.push({year:d,netEquity:ve})}const B=p-u+ee;ae[a]+=B;const _=B-z,ze=z>0?_/z*100:0,be=re&&_>0?_*c:0,Be=B-be;let fe=null;l===0&&m>0&&(fe=(Math.pow(B/m,1/a)-1)*100);let ne=Pe(ae);ne!==null&&(ne*=100),C.push({scenarioId:s.id,scenarioName:s.name,finalNetEquity:Math.round(B),netEquityAfterTax:Math.round(Be),finalAssetValue:Math.round(p),totalOwnCapital:z,netProfitOnCapital:Math.round(_),roiOnCapital:ze,cagr:fe,irr:ne,totalLoanInterestPaid:Math.round(pe),finalTaxAmount:Math.round(be),breakdown:ge,allocations:s.isMixed?s.allocations:void 0}),te.forEach(d=>{const f=b.find(w=>w.year===d.year);f?f[s.name]=Math.round(d.netEquity):b.push({year:d.year,[s.name]:Math.round(d.netEquity)})})}Ae(C),Ie(b.sort((s,x)=>s.year-x.year)),X.success("Comparison complete!")},De=t=>{if(!O)return;const n=O.find(a=>a.scenarioId===t);n&&n.breakdown&&he({scenarioName:n.scenarioName,data:n.breakdown})},$e=()=>{Te(t=>!t)},F=({title:t,enExplanation:n,viExplanation:a,enExample:l,viExample:c})=>e.jsxs("div",{className:"py-3 border-b border-slate-700/80 last:border-b-0",children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-1.5",children:t}),e.jsxs("div",{className:"pl-1",children:[e.jsxs("p",{className:"text-sm text-slate-300",children:[e.jsx("strong",{className:"text-slate-100",children:"EN:"})," ",n," ",e.jsx("br",{}),e.jsxs("em",{className:"text-slate-500 text-xs",children:["Example: ",l]})]}),e.jsxs("p",{className:"text-sm text-slate-300 mt-1.5",children:[e.jsx("strong",{className:"text-slate-100",children:"VI:"})," ",a," ",e.jsx("br",{}),e.jsxs("em",{className:"text-slate-500 text-xs",children:["Ví dụ: ",c]})]})]})]}),T=({label:t,value:n,isPrimary:a=!1,isDanger:l=!1,className:c=""})=>e.jsxs("div",{className:`flex justify-between items-center py-1.5 ${a?"text-base":"text-sm"} ${c}`,children:[e.jsx("span",{className:`${a?"font-semibold text-white":"text-slate-400"}`,children:t}),e.jsx("strong",{className:`${l?"text-red-400":a?"text-white font-bold":"text-slate-200 font-medium"}`,children:n})]}),Oe=$.filter(t=>!t.isMixed);return e.jsxs(e.Fragment,{children:[e.jsx(le,{children:ue&&e.jsx(ot,{content:ue,onClose:()=>he(null)})}),e.jsx(ie,{title:"Investment Scenario Comparison",icon:e.jsx(Ke,{}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-4 border border-slate-700 rounded-lg bg-slate-800/40",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"initialCapital",className:"block text-sm font-semibold text-slate-300 mb-2",children:"Initial Own Capital"}),e.jsx("input",{type:"text",id:"initialCapital",value:A,onChange:U(v),className:"w-full p-2 rounded-md bg-slate-700 border-slate-600 text-slate-100"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"loanAmount",className:"block text-sm font-semibold text-slate-300 mb-2",children:"Loan Amount (for leverage)"}),e.jsx("input",{type:"text",id:"loanAmount",value:y,onChange:U(j),className:"w-full p-2 rounded-md bg-slate-700 border-slate-600 text-slate-100"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"investmentHorizon",className:"block text-sm font-semibold text-slate-300 mb-2",children:"Investment Horizon (Years)"}),e.jsx("input",{type:"text",id:"investmentHorizon",value:r,onChange:xe(o),className:"w-full p-2 rounded-md bg-slate-700 border-slate-600 text-slate-100"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"annualDCA",className:"block text-sm font-semibold text-slate-300 mb-2",children:"Annual Add. Investment (DCA)"}),e.jsx("input",{type:"text",id:"annualDCA",value:D,onChange:U(H),className:"w-full p-2 rounded-md bg-slate-700 border-slate-600 text-slate-100"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"investmentTaxRate",className:"block text-sm font-semibold text-slate-300 mb-2",children:"Profit Tax Rate (%)"}),e.jsx("input",{type:"text",id:"investmentTaxRate",value:G,onChange:xe(i),className:"w-full p-2 rounded-md bg-slate-700 border-slate-600 text-slate-100"})]}),e.jsx("div",{className:"flex items-end pb-2",children:e.jsxs("label",{className:"flex items-center text-slate-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:re,onChange:t=>Ne(t.target.checked),className:"h-4 w-4 rounded bg-slate-600 border-white/50 text-white focus:ring-white mr-2"}),"Apply Tax on Net Profit"]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-[auto_1fr_repeat(7,minmax(0,1fr))_auto] gap-x-3 items-center px-3 py-2 text-xs text-slate-400 font-medium uppercase border-b border-slate-700",children:[e.jsx("div",{title:"Enable/Disable"}),e.jsx("div",{className:"text-left",children:"Scenario"}),e.jsx("div",{className:"text-right",children:"Return %"}),e.jsx("div",{className:"text-right",children:"Costs %"}),e.jsx("div",{className:"text-center",children:"Reinvest"}),e.jsx("div",{className:"text-center",children:"Leverage"}),e.jsx("div",{className:"text-left text-xs",children:"Loan Type"}),e.jsx("div",{className:"text-right",children:"Loan Rate %"}),e.jsx("div",{className:"text-center"}),e.jsx("div",{className:"text-right",children:"Actions"})]}),$.map(t=>e.jsxs(He.Fragment,{children:[e.jsxs("div",{className:`grid grid-cols-[auto_1fr_repeat(7,minmax(0,1fr))_auto] gap-x-3 items-center px-3 py-2 rounded-lg transition-colors ${t.enabled?"bg-slate-800/40":"bg-slate-800/10"}`,children:[e.jsx("input",{type:"checkbox",checked:t.enabled,onChange:n=>I(t.id,"enabled",n.target.checked),className:"h-4 w-4 rounded bg-slate-600 border-white/50 text-white focus:ring-white"}),t.isMixed?e.jsx("input",{type:"text",value:t.name,onChange:n=>I(t.id,"name",n.target.value),className:"bg-transparent text-sm font-bold p-1 border-0 rounded focus:ring-1 focus:ring-sky-400",style:{color:t.color}}):e.jsx("h3",{style:{color:t.color},className:"text-sm font-bold",children:t.name}),e.jsx("input",{type:"text",value:t.expectedReturn,onChange:n=>I(t.id,"expectedReturn",n.target.value),className:"w-full p-1 rounded-md bg-slate-700 text-xs text-right",disabled:t.isMixed||!t.enabled}),e.jsx("input",{type:"text",value:t.annualCosts,onChange:n=>I(t.id,"annualCosts",n.target.value),className:"w-full p-1 rounded-md bg-slate-700 text-xs text-right",disabled:t.isMixed||!t.enabled}),e.jsx("div",{className:"flex justify-center",children:e.jsx("input",{type:"checkbox",checked:t.reinvest,onChange:n=>I(t.id,"reinvest",n.target.checked),className:"h-4 w-4 rounded bg-slate-600 border-white/50 text-white focus:ring-white",disabled:!t.enabled})}),e.jsx("div",{className:"flex justify-center",children:e.jsx("input",{type:"checkbox",checked:t.useLeverage,onChange:n=>I(t.id,"useLeverage",n.target.checked),className:"h-4 w-4 rounded bg-slate-600 border-white/50 text-white focus:ring-white",disabled:!t.enabled})}),e.jsxs("select",{value:t.loanType,onChange:n=>I(t.id,"loanType",n.target.value),className:`w-full p-1 rounded-md bg-slate-700 text-xs ${!t.useLeverage&&"opacity-50"}`,disabled:!t.useLeverage||!t.enabled,children:[e.jsx("option",{value:"annuity",children:"Annuity"}),e.jsx("option",{value:"interestOnly",children:"Interest-Only"}),e.jsx("option",{value:"balloon",children:"Balloon"})]}),e.jsx("input",{type:"text",value:t.loanInterestRate,onChange:n=>I(t.id,"loanInterestRate",n.target.value),className:`w-full p-1 rounded-md bg-slate-700 text-xs text-right ${!t.useLeverage&&"opacity-50"}`,disabled:!t.useLeverage||!t.enabled}),e.jsx("div",{className:"flex justify-center",children:t.isMixed&&e.jsx("button",{onClick:()=>ke(t.id===ce?null:t.id),className:"p-1 rounded-md hover:bg-slate-600 text-slate-400 hover:text-white",title:"Configure Portfolio",children:e.jsx(Ge,{className:"w-4 h-4"})})}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>De(t.id),disabled:!O,className:"p-1 rounded-md hover:bg-slate-600 text-slate-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed",title:"View Breakdown",children:e.jsx(_e,{className:"w-4 h-4"})}),t.isMixed&&e.jsx("button",{onClick:()=>Me(t.id),className:"p-1 rounded-md hover:bg-slate-600 text-slate-400 hover:text-red-400",title:"Remove Portfolio",children:e.jsx(We,{className:"w-4 h-4"})})]})]}),Fe(t)&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-amber-400 bg-amber-900/20 border-l-4 border-amber-500 px-3 py-1.5 -mt-1 rounded-b-lg",children:[e.jsx(je,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:"Warning: Net return is lower than loan rate – leverage may cause losses."})]}),e.jsx(le,{children:t.isMixed&&t.allocations&&ce===t.id&&e.jsx(S.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-slate-900/50 p-3 rounded-b-lg -mt-2 border-x border-b border-slate-700 overflow-hidden",children:e.jsxs("div",{className:"space-y-2",children:[t.allocations.map((n,a)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("select",{value:n.scenarioId,onChange:l=>me(t.id,a,"scenarioId",l.target.value),className:"w-1/2 p-1.5 rounded-md bg-slate-700 text-xs focus:ring-sky-400 focus:border-sky-400 border-slate-600",children:Oe.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))}),e.jsx("input",{type:"text",value:n.percentage,onChange:l=>me(t.id,a,"percentage",l.target.value),className:"w-1/2 p-1.5 rounded-md bg-slate-700 text-xs focus:ring-sky-400 focus:border-sky-400 border-slate-600",placeholder:"Percentage %"}),e.jsx("button",{onClick:()=>Ee(t.id,a),className:"text-red-400 hover:text-red-300",children:e.jsx(Xe,{className:"w-4 h-4"})})]},a)),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("button",{onClick:()=>Re(t.id),className:"flex items-center text-xs text-white hover:text-slate-200",children:[e.jsx(we,{className:"w-4 h-4 mr-1"}),"Add Asset"]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Total: ",e.jsxs("span",{className:"font-bold",children:[t.allocations.reduce((n,a)=>n+(parseFloat(a.percentage)||0),0),"%"]})]})]})]})})})]},t.id))]}),e.jsx("div",{className:"pt-4 border-t border-slate-700/50",children:e.jsxs(S.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:Le,className:"flex items-center text-sm bg-slate-700/50 hover:bg-slate-600/70 border border-slate-600 backdrop-blur-sm text-white font-medium py-2 px-3 rounded-lg shadow-md transition-all duration-300",children:[e.jsx(we,{className:"w-5 h-5 mr-1.5"})," Add Mixed Portfolio"]})}),e.jsx(S.button,{onClick:Se,whileHover:{scale:1.02,boxShadow:"0 0 15px rgba(56, 189, 248, 0.2)",borderColor:"rgba(56, 189, 248, 0.4)"},whileTap:{scale:.98},className:"w-full bg-sky-500/20 hover:bg-sky-500/30 border border-sky-500/40 backdrop-blur-sm text-sky-200 font-semibold py-3 px-4 rounded-lg shadow-md transition-all duration-300",children:"Compare Investments"})]})}),O&&e.jsxs(ie,{title:"Comparison Results",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:O.map(t=>{const n=t.netEquityAfterTax-t.totalOwnCapital,a=t.totalOwnCapital>0?n/t.totalOwnCapital*100:0;return e.jsxs("div",{className:`p-4 rounded-lg border bg-slate-800/40 space-y-2 transition-all ${a<0?"border-red-500/50 bg-red-900/10":"border-slate-700"}`,children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center",children:[t.scenarioName,a<0&&e.jsx(je,{className:"w-5 h-5 text-red-400 inline-block ml-2"})]}),e.jsx(T,{label:"Final Net Equity (After Tax)",value:V(t.netEquityAfterTax),isPrimary:!0}),e.jsx(T,{label:"Return on Capital (After Tax)",value:`${a.toFixed(2)}%`,isPrimary:!0,isDanger:a<0}),e.jsx("hr",{className:"border-slate-600"}),e.jsx(T,{label:"IRR (Internal Rate of Return)",value:t.irr!==null?`${t.irr.toFixed(2)}%`:"N/A"}),e.jsx(T,{label:"CAGR (Compounded Growth)",value:t.cagr!==null?`${t.cagr.toFixed(2)}%`:"N/A (DCA)"}),e.jsx("hr",{className:"border-slate-600"}),e.jsx(T,{label:"Net Profit (Before Tax)",value:V(t.netProfitOnCapital)}),e.jsx(T,{label:"Tax on Profit",value:`(${V(t.finalTaxAmount)})`,isDanger:t.finalTaxAmount>0}),e.jsx(T,{label:"Final Net Equity (Before Tax)",value:V(t.finalNetEquity)}),e.jsx(T,{label:"Total Own Capital",value:V(t.totalOwnCapital)})]},t.scenarioId)})}),de.length>0&&e.jsx(it,{data:de,scenarios:$})]}),e.jsxs(ie,{title:"How to Use This Calculator",icon:e.jsx(Qe,{}),children:[e.jsx(S.button,{whileHover:{scale:1.03,boxShadow:"0 0 15px rgba(56, 189, 248, 0.2)",borderColor:"rgba(56, 189, 248, 0.4)"},whileTap:{scale:.97},onClick:$e,"aria-expanded":K,"aria-controls":"comparison-instructions-content",className:"w-full sm:w-auto mb-4 bg-sky-500/20 hover:bg-sky-500/30 border border-sky-500/40 backdrop-blur-sm text-white font-semibold py-2 px-4 rounded-lg shadow-md transition-all duration-300 text-sm",children:K?"Hide Instructions":"Show Instructions"}),e.jsx(le,{children:K&&e.jsxs(S.div,{id:"comparison-instructions-content",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-1 overflow-hidden bg-slate-800/60 p-4 rounded-lg border border-slate-700 shadow-inner",children:[e.jsx(F,{title:"General Parameters",enExplanation:"These settings apply globally. 'Initial Own Capital' is your starting cash. 'Loan Amount' is used by any scenario with 'Leverage' enabled. 'Horizon' is the investment duration. 'Annual DCA' is extra capital added each year.",viExplanation:"Các thiết lập này áp dụng chung. 'Vốn tự có ban đầu' là tiền mặt của bạn. 'Số tiền vay' được dùng cho các kịch bản bật 'Đòn bẩy'. 'Thời gian đầu tư' là số năm. 'Đầu tư bổ sung (DCA)' là vốn góp thêm mỗi năm.",enExample:"Initial: 500,000,000, Loan: 1,000,000,000, Horizon: 10 years, DCA: 50,000,000/year",viExample:"Vốn ban đầu: 500.000.000, Vay: 1.000.000.000, Thời gian: 10 năm, DCA: 50.000.000/năm"}),e.jsx(F,{title:"Tax Model",enExplanation:"If 'Apply Tax' is checked, the 'Profit Tax Rate' will be applied to the 'Net Profit on Capital' at the end of the investment period. This calculates your final after-tax equity.",viExplanation:"Nếu chọn 'Áp dụng thuế', 'Thuế suất lợi nhuận' sẽ được áp dụng trên 'Lợi nhuận ròng trên vốn' vào cuối kỳ đầu tư. Thao tác này sẽ tính toán giá trị tài sản ròng sau thuế cuối cùng của bạn.",enExample:"Apply Tax: checked, Rate: 20%. Tax = Net Profit * 20%.",viExample:"Áp dụng thuế: đã chọn, Thuế suất: 20%. Thuế = Lợi nhuận ròng * 20%."}),e.jsx(F,{title:"Scenario Parameters",enExplanation:"'Return %' is annual asset growth. 'Costs %' are annual fees based on asset value. 'Reinvest' toggles profit compounding. 'Leverage' enables using the loan.",viExplanation:"'Tỷ suất lợi nhuận %' là tăng trưởng tài sản hàng năm. 'Chi phí %' là phí hàng năm dựa trên giá trị tài sản. 'Tái đầu tư' bật/tắt lãi kép. 'Đòn bẩy' cho phép sử dụng vốn vay.",enExample:"Return: 12%, Costs: 0.5%, Reinvest: checked, Leverage: checked.",viExample:"Lợi nhuận: 12%, Chi phí: 0.5%, Tái đầu tư: đã chọn, Đòn bẩy: đã chọn."}),e.jsx(F,{title:"Loan Types",enExplanation:"'Annuity': Equal annual payments. 'Interest-Only': Pay only interest annually, principal at the end. 'Balloon': Pay everything (principal + all accrued interest) at the end.",viExplanation:"'Trả góp đều': Trả đều hàng năm cả gốc lẫn lãi. 'Chỉ trả lãi': Chỉ trả lãi hàng năm, trả toàn bộ gốc cuối kỳ. 'Trả toàn bộ cuối kỳ': Trả toàn bộ (gốc + toàn bộ lãi tích lũy) vào cuối kỳ.",enExample:"Select 'Interest-Only' for lower annual cash outflow.",viExample:"Chọn 'Chỉ trả lãi' để có dòng tiền hàng năm thấp hơn."}),e.jsx(F,{title:"Mixed Portfolio",enExplanation:"Create a custom portfolio by combining assets. Click 'Configure' (cog icon) to set allocations. Percentages must sum to 100%. Return and costs are weighted averages.",viExplanation:"Tạo danh mục tùy chỉnh bằng cách kết hợp các tài sản. Nhấp vào 'Cấu hình' (biểu tượng bánh răng) để thiết lập tỷ trọng. Tổng tỷ trọng phải là 100%. Lợi nhuận và chi phí là trung bình có trọng số.",enExample:"Add Portfolio, Configure -> Stocks: 60%, Real Estate: 40%.",viExample:"Thêm Danh mục, Cấu hình -> Cổ phiếu: 60%, Bất động sản: 40%."}),e.jsx(F,{title:"Results & Metrics (IRR, CAGR)",enExplanation:"'IRR' (Internal Rate of Return) is the most accurate metric for investments with cash flows like DCA, showing the true annualized return. 'CAGR' (Compounded Annual Growth Rate) shows average growth and is only calculated for non-DCA cases for simplicity.",viExplanation:"'IRR' (Tỷ suất hoàn vốn nội bộ) là chỉ số chính xác nhất cho các khoản đầu tư có dòng tiền (như DCA), cho thấy tỷ suất sinh lời thực hàng năm. 'CAGR' (Tốc độ tăng trưởng kép hàng năm) thể hiện mức tăng trưởng trung bình và chỉ được tính cho các trường hợp không có DCA để đơn giản hóa.",enExample:"A high IRR indicates a more profitable investment over time.",viExample:"IRR cao cho thấy một khoản đầu tư sinh lời tốt hơn theo thời gian."})]})})]})]})};export{ht as default};
