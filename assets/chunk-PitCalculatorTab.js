import{r as c,j as e,P as R,a as A,m as F,b as E,_ as M}from"./app.js";import{S as v}from"./chunk-Section.js";const $=({title:n,formulaType:d,formulaId:b,cellRef:m})=>{const[f,u]=c.useState(null),N=async(p,i)=>{try{await navigator.clipboard.writeText(p),M.success(`Copied formula using cell: ${m.trim()||"A1"}`),u(i),setTimeout(()=>u(null),2e3)}catch(s){M.error("Failed to copy formula."),console.error("Failed to copy: ",s)}},x=(p,i)=>{const s=i&&/^[A-Z]+[1-9][0-9]*$/.test(i)?i:"A1",y=`=MAX(0,MIN(${s},5000000))*0.05+MAX(0,MIN(${s},10000000)-5000000)*0.10+MAX(0,MIN(${s},18000000)-10000000)*0.15+MAX(0,MIN(${s},32000000)-18000000)*0.20+MAX(0,MIN(${s},52000000)-32000000)*0.25+MAX(0,MIN(${s},80000000)-52000000)*0.30+MAX(0,${s}-80000000)*0.35`,I=`=MAX(0,MIN(${s},60000000))*0.05+MAX(0,MIN(${s},120000000)-60000000)*0.10+MAX(0,MIN(${s},216000000)-120000000)*0.15+MAX(0,MIN(${s},384000000)-216000000)*0.20+MAX(0,MIN(${s},624000000)-384000000)*0.25+MAX(0,MIN(${s},960000000)-624000000)*0.30+MAX(0,${s}-960000000)*0.35`;return p==="monthly"?y:I},h=x(d,"A1"),g=x(d,m.trim()||"A1");return e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-md font-semibold text-white mb-2",children:n}),e.jsxs("div",{className:"flex items-start sm:items-center space-x-2 bg-slate-900/50 p-3 rounded-lg border border-slate-700/60",children:[e.jsx("pre",{className:"text-xs text-slate-300 whitespace-pre-wrap break-all flex-grow font-mono",children:h}),e.jsx(F.button,{whileHover:{scale:1.1,boxShadow:"0 0 10px rgba(56, 189, 248, 0.2)"},whileTap:{scale:.9},onClick:()=>N(g,b),title:"Copy formula",className:"p-2 rounded-md bg-sky-500/30 hover:bg-sky-500/40 text-sky-200 transition-all duration-300 flex-shrink-0","aria-label":`Copy ${n} to clipboard using ${m.trim()||"A1"}`,children:f===b?e.jsx(E,{className:"w-4 h-4 text-green-400"}):e.jsx(A,{className:"w-4 h-4"})})]})]})},B=()=>{const[n,d]=c.useState(""),[b,m]=c.useState(0),[f,u]=c.useState([]),[N,x]=c.useState(0),[h,g]=c.useState(""),p=t=>{g(t.target.value.toUpperCase())},i=t=>t.toLocaleString("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0,maximumFractionDigits:0}),s=t=>{if(t<=0)return 0;let l=0;return t<=5e6?l=t*.05:t<=1e7?l=25e4+(t-5e6)*.1:t<=18e6?l=75e4+(t-1e7)*.15:t<=32e6?l=195e4+(t-18e6)*.2:t<=52e6?l=475e4+(t-32e6)*.25:t<=8e7?l=975e4+(t-52e6)*.3:l=1815e4+(t-8e7)*.35,Math.round(l)},y=t=>{const l=[];if(t<=0)return l;const r=a=>i(a);let j=0;const w=[{type:"upTo",threshold:0,limit:5e6,rate:.05,label:(a,o)=>`Up to ${r(o)} (Rate: 5%)`},{type:"range",threshold:5e6,limit:1e7,rate:.1,label:(a,o)=>`> ${r(a)} to ${r(o)} (Rate: 10%)`},{type:"range",threshold:1e7,limit:18e6,rate:.15,label:(a,o)=>`> ${r(a)} to ${r(o)} (Rate: 15%)`},{type:"range",threshold:18e6,limit:32e6,rate:.2,label:(a,o)=>`> ${r(a)} to ${r(o)} (Rate: 20%)`},{type:"range",threshold:32e6,limit:52e6,rate:.25,label:(a,o)=>`> ${r(a)} to ${r(o)} (Rate: 25%)`},{type:"range",threshold:52e6,limit:8e7,rate:.3,label:(a,o)=>`> ${r(a)} to ${r(o)} (Rate: 30%)`},{type:"above",threshold:8e7,limit:1/0,rate:.35,label:(a,o)=>`> ${r(a)} to ... (Rate: 35%)`}];for(const a of w){if(t<=a.threshold&&a.type!=="upTo")continue;let o=0;if(a.type==="above"?o=Math.max(0,t-a.threshold):o=Math.max(0,Math.min(t,a.limit)-a.threshold),o>0){const k=o*a.rate,T=a.label(a.threshold,a.limit);l.push(e.jsxs("p",{className:"text-sm",children:[T,": ",e.jsx("strong",{className:"text-slate-200",children:r(k)})]},`step-${j++}`))}if(a.type!=="above"&&t<=a.limit)break}return l},I=()=>{const t=n.replace(/\./g,""),l=Number(t);if(n===""||isNaN(l)||l<0){m(0),u([]),x(0);return}const r=s(l);m(r),l>0?(u(y(l)),x(r/l*100)):(u([]),x(0))},C=t=>{const l=t.target.value.replace(/[^0-9]/g,"");if(l==="")d("");else try{const r=BigInt(l),j=new Intl.NumberFormat("vi-VN").format(r);d(j)}catch{d(l)}};return c.useEffect(()=>{I()},[n]),e.jsxs(e.Fragment,{children:[e.jsx(v,{title:"Vietnam Monthly PIT Calculator",icon:e.jsx(R,{}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"taxableIncome",className:"block text-sm font-semibold text-slate-300 mb-2",children:"Monthly Taxable Income (VND)"}),e.jsx("input",{type:"text",id:"taxableIncome",value:n,onChange:C,placeholder:"e.g., 15.000.000",className:"w-full p-3 rounded-lg bg-slate-800/60 border border-slate-600/80 focus:ring-2 focus:ring-sky-400 focus:border-sky-400 text-slate-100 transition-colors",inputMode:"numeric"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-white mt-6 mb-2",children:"PIT Calculation Result:"}),e.jsxs("div",{className:"space-y-2 text-slate-300 bg-slate-900/30 p-4 rounded-lg border border-slate-700/50 min-h-[120px]",children:[(()=>{const t=n.replace(/\./g,""),l=Number(t);return n!==""&&!isNaN(l)&&l>0&&f.length>0?f:n===""||n!==""&&!isNaN(l)&&l===0?e.jsx("p",{className:"text-sm text-slate-400",children:"Enter a taxable income above 0 to see the detailed breakdown."}):e.jsx("p",{className:"text-sm text-rose-400",children:"Invalid input. Please enter a valid number."})})(),e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-600/70 space-y-2",children:[e.jsxs("p",{className:"text-md font-semibold",children:["Total Monthly PIT: ",e.jsx("strong",{className:"text-white font-bold",children:i(b)})]}),e.jsxs("p",{className:"text-md font-semibold",children:["Effective Tax Rate: ",e.jsxs("strong",{className:"text-white font-bold",children:[N.toFixed(2),"%"]})]})]})]})]})]})}),e.jsxs(v,{title:"Excel PIT Calculation Formulas",icon:e.jsx(A,{}),children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"excelCellRef-shared",className:"block text-sm font-semibold text-slate-300 mb-2",children:"Enter Excel Cell for Taxable Income:"}),e.jsx("input",{type:"text",id:"excelCellRef-shared",value:h,onChange:p,placeholder:"e.g., B5",className:"w-full sm:w-auto p-2 rounded-lg bg-slate-800/60 border border-slate-600/80 focus:ring-2 focus:ring-sky-400 focus:border-sky-400 text-slate-100 transition-colors",maxLength:10})]}),e.jsx($,{title:"For Monthly Taxable Income (Example using A1):",formulaType:"monthly",formulaId:"monthly",cellRef:h}),e.jsx($,{title:"For Annual Taxable Income (Example using A1):",formulaType:"annual",formulaId:"annual",cellRef:h}),e.jsx("p",{className:"text-xs text-slate-500 mt-4",children:'Note: The formulas displayed above use "A1" as a template. When you click "Copy", the formula copied to your clipboard will use the cell reference you entered above (e.g., B5). If the input is empty or invalid for an Excel cell reference, the copied formula will default to "A1". Ensure the entered cell reference is valid (e.g., A1, B10, AA100).'})]})]})};export{B as default};
